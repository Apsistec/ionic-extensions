{"version":3,"file":"dialog-module.js","sources":["ng://@co.mmons/ionic-extensions/dialog/dialog-data-symbol.ts","ng://@co.mmons/ionic-extensions/dialog/dialog-instance-symbol.ts","ng://@co.mmons/ionic-extensions/dialog/dialog.ts","ng://@co.mmons/ionic-extensions/dialog/dialog-controller.ts","ng://@co.mmons/ionic-extensions/dialog/index.ts","ng://@co.mmons/ionic-extensions/dialog/dialog-module.ts"],"sourcesContent":["export const dialogData = Symbol();\n","export const dialogInstance = Symbol();\n","import {\n    ChangeDetectionStrategy, ChangeDetectorRef,\n    Component,\n    ComponentFactoryResolver,\n    ComponentRef,\n    ElementRef,\n    EventEmitter,\n    Injector,\n    Input,\n    OnDestroy,\n    OnInit,\n    Type,\n    ViewChild,\n    ViewContainerRef\n} from \"@angular/core\";\nimport {DomSanitizer, SafeHtml} from \"@angular/platform-browser\";\nimport {ModalController} from \"@ionic/angular\";\nimport {DialogButton} from \"./dialog-button\";\nimport {dialogData} from \"./dialog-data-symbol\";\nimport {dialogInstance} from \"./dialog-instance-symbol\";\nimport {DialogMessageComponent} from \"./dialog-message-component\";\nimport {DialogOptions} from \"./dialog-options\";\n\n@Component({\n    selector: \"ionx-dialog\",\n    changeDetection: ChangeDetectionStrategy.OnPush,\n    templateUrl: \"dialog.html\",\n    styleUrls: [\"dialog.scss\"]\n})\nexport class Dialog implements OnInit, OnDestroy, DialogOptions {\n\n    constructor(\n        private injector: Injector,\n        private sanitizer: DomSanitizer,\n        public elementRef: ElementRef<HTMLElement>,\n        private modalController: ModalController,\n        protected resolver: ComponentFactoryResolver,\n        private changeDetectorRef: ChangeDetectorRef\n    ) {}\n\n    messageText: SafeHtml;\n\n    messageComponent: ComponentRef<any>;\n\n    @ViewChild(\"messageComponentContainer\", {read: ViewContainerRef, static: true})\n    private messageComponentContainer: ViewContainerRef;\n\n    @Input()\n    header: string;\n\n    _buttons: DialogButton[];\n\n    @Input()\n    set buttons(buttons: DialogButton[]) {\n        this._buttons = buttons;\n        this.changeDetectorRef.detectChanges();\n    }\n\n    get buttons(): DialogButton[] {\n        return this._buttons;\n    }\n\n    readonly didLoad: EventEmitter<any> = new EventEmitter();\n\n    @Input()\n    set message(message: string | ComponentRef<any> | Type<any> | [Type<any>, {[param: string]: any}]) {\n\n        if (typeof message === \"string\") {\n            this.messageText = this.sanitizer.bypassSecurityTrustHtml(message);\n\n            if (this.messageComponent) {\n                this.messageComponent.destroy();\n            }\n\n            this.messageComponent = undefined;\n\n        } else if (message) {\n            this.messageText = undefined;\n\n            this.messageComponentContainer.clear();\n\n            if (!(message instanceof ComponentRef)) {\n\n                let type: Type<any>;\n                let params: {[param: string]: any};\n\n                if (Array.isArray(message)) {\n                    type = message.length >= 1 ? message[0] : undefined;\n                    params = message.length >= 2 ? message[1] : undefined;\n                } else {\n                    type = message;\n                }\n\n                message = this.resolver.resolveComponentFactory(type).create(this.injector);\n\n                if (params) {\n                    for (const param of Object.keys(params)) {\n                        message.instance[param] = params[param];\n                    }\n                }\n            }\n\n            this.messageComponent = message;\n            this.messageComponent.instance[dialogInstance] = this;\n\n            this.messageComponentContainer.insert(this.messageComponent.hostView);\n        }\n\n    }\n\n    /*private*/ buttonClicked(button: DialogButton) {\n\n        const value = this.messageComponent && this.messageComponent.instance[dialogData] ? (<DialogMessageComponent>this.messageComponent.instance)[dialogData]() : undefined;\n\n        if (button.handler) {\n            const res = button.handler(value);\n\n            if ((typeof res === \"boolean\" && res) || typeof res !== \"boolean\") {\n                this.modalController.dismiss(value, button.role);\n            }\n\n            return;\n\n        } else {\n            this.modalController.dismiss(button.role !== \"cancel\" ? value : undefined, button.role);\n        }\n    }\n\n    ngOnDestroy(): void {\n\n        if (this.messageComponent) {\n            this.messageComponent.instance[dialogInstance] = undefined;\n            this.messageComponent.destroy();\n        }\n    }\n\n    ngOnInit(): void {\n        const modal = this.elementRef.nativeElement.closest(\"ion-modal\");\n\n        modal.style.setProperty(\"--width\", \"300px\");\n        modal.style.setProperty(\"--height\", \"auto\");\n        modal.style.setProperty(\"--max-width\", \"90%\");\n        modal.style.setProperty(\"--max-height\", \"90%\");\n\n        if (document.querySelector(\"html.ios\")) {\n            modal.style.setProperty(\"--border-radius\", \"10px\");\n        } else {\n            modal.style.setProperty(\"--border-radius\", \"4px\");\n            modal.style.setProperty(\"--box-shadow\", \"0 28px 48px rgba(0,0,0,0.4)\");\n        }\n    }\n\n    ionViewDidEnter() {\n        const input = this.elementRef.nativeElement.querySelector(\"input\");\n        if (input) {\n            input.focus();\n        }\n    }\n}\n","import {Injectable} from \"@angular/core\";\nimport {ModalController} from \"@ionic/angular\";\nimport {Dialog} from \"./dialog\";\nimport {DialogOptions} from \"./dialog-options\";\n\n@Injectable()\nexport class DialogController {\n\n    constructor(protected modalController: ModalController) {\n    }\n\n    async create(options: DialogOptions) {\n\n        return this.modalController.create(Object.assign({}, options, {\n            component: Dialog,\n            componentProps: {\n                header: options.header,\n                message: options.message,\n                buttons: options.buttons\n            }\n        }));\n    }\n\n    /**\n     * When `id` is not provided, it dismisses the top overlay.\n     */\n    dismiss(data?: any, role?: string, id?: string) {\n        return this.modalController.dismiss(data, role, id);\n    }\n\n}\n\n\n","import {CommonModule} from \"@angular/common\";\nimport {NgModule} from \"@angular/core\";\nimport {IntlModule} from \"@co.mmons/angular-intl\";\nimport {IonicModule} from \"@ionic/angular\";\nimport {ButtonsModule} from \"@co.mmons/ionic-extensions/buttons\";\nimport {Dialog} from \"./dialog\";\nimport {DialogController} from \"./dialog-controller\";\n\nexport {Dialog} from \"./dialog\";\nexport {DialogButton} from \"./dialog-button\";\nexport {DialogController} from \"./dialog-controller\";\nexport {dialogData} from \"./dialog-data-symbol\";\nexport {dialogInstance} from \"./dialog-instance-symbol\";\nexport {DialogMessageComponent} from \"./dialog-message-component\";\n\n@NgModule({\n    declarations: [Dialog],\n    imports: [IntlModule, IonicModule, CommonModule, ButtonsModule],\n    entryComponents: [Dialog],\n    providers: [DialogController]\n})\nexport class DialogModule {\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":";;;;;;;;MAAa,UAAU,GAAG,MAAM,EAAE;;MCArB,cAAc,GAAG,MAAM,EAAE;;IC6BzB,MAAM,GAAnB,MAAa,MAAM;IAEf,YACY,QAAkB,EAClB,SAAuB,EACxB,UAAmC,EAClC,eAAgC,EAC9B,QAAkC,EACpC,iBAAoC;QALpC,aAAQ,GAAR,QAAQ,CAAU;QAClB,cAAS,GAAT,SAAS,CAAc;QACxB,eAAU,GAAV,UAAU,CAAyB;QAClC,oBAAe,GAAf,eAAe,CAAiB;QAC9B,aAAQ,GAAR,QAAQ,CAA0B;QACpC,sBAAiB,GAAjB,iBAAiB,CAAmB;QAyBvC,YAAO,GAAsB,IAAI,YAAY,EAAE,CAAC;KAxBrD;IAeJ,IAAI,OAAO,CAAC,OAAuB;QAC/B,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC;QACxB,IAAI,CAAC,iBAAiB,CAAC,aAAa,EAAE,CAAC;KAC1C;IAED,IAAI,OAAO;QACP,OAAO,IAAI,CAAC,QAAQ,CAAC;KACxB;IAKD,IAAI,OAAO,CAAC,OAAqF;QAE7F,IAAI,OAAO,OAAO,KAAK,QAAQ,EAAE;YAC7B,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,uBAAuB,CAAC,OAAO,CAAC,CAAC;YAEnE,IAAI,IAAI,CAAC,gBAAgB,EAAE;gBACvB,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,CAAC;aACnC;YAED,IAAI,CAAC,gBAAgB,GAAG,SAAS,CAAC;SAErC;aAAM,IAAI,OAAO,EAAE;YAChB,IAAI,CAAC,WAAW,GAAG,SAAS,CAAC;YAE7B,IAAI,CAAC,yBAAyB,CAAC,KAAK,EAAE,CAAC;YAEvC,IAAI,EAAE,OAAO,YAAY,YAAY,CAAC,EAAE;gBAEpC,IAAI,IAAe,CAAC;gBACpB,IAAI,MAA8B,CAAC;gBAEnC,IAAI,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE;oBACxB,IAAI,GAAG,OAAO,CAAC,MAAM,IAAI,CAAC,GAAG,OAAO,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC;oBACpD,MAAM,GAAG,OAAO,CAAC,MAAM,IAAI,CAAC,GAAG,OAAO,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC;iBACzD;qBAAM;oBACH,IAAI,GAAG,OAAO,CAAC;iBAClB;gBAED,OAAO,GAAG,IAAI,CAAC,QAAQ,CAAC,uBAAuB,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;gBAE5E,IAAI,MAAM,EAAE;oBACR,KAAK,MAAM,KAAK,IAAI,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE;wBACrC,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC;qBAC3C;iBACJ;aACJ;YAED,IAAI,CAAC,gBAAgB,GAAG,OAAO,CAAC;YAChC,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,cAAc,CAAC,GAAG,IAAI,CAAC;YAEtD,IAAI,CAAC,yBAAyB,CAAC,MAAM,CAAC,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;SACzE;KAEJ;gBAEW,aAAa,CAAC,MAAoB;QAE1C,MAAM,KAAK,GAAG,IAAI,CAAC,gBAAgB,IAAI,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,UAAU,CAAC,GAA4B,IAAI,CAAC,gBAAgB,CAAC,QAAS,CAAC,UAAU,CAAC,EAAE,GAAG,SAAS,CAAC;QAEvK,IAAI,MAAM,CAAC,OAAO,EAAE;YAChB,MAAM,GAAG,GAAG,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;YAElC,IAAI,CAAC,OAAO,GAAG,KAAK,SAAS,IAAI,GAAG,KAAK,OAAO,GAAG,KAAK,SAAS,EAAE;gBAC/D,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,KAAK,EAAE,MAAM,CAAC,IAAI,CAAC,CAAC;aACpD;YAED,OAAO;SAEV;aAAM;YACH,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,KAAK,QAAQ,GAAG,KAAK,GAAG,SAAS,EAAE,MAAM,CAAC,IAAI,CAAC,CAAC;SAC3F;KACJ;IAED,WAAW;QAEP,IAAI,IAAI,CAAC,gBAAgB,EAAE;YACvB,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,cAAc,CAAC,GAAG,SAAS,CAAC;YAC3D,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,CAAC;SACnC;KACJ;IAED,QAAQ;QACJ,MAAM,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;QAEjE,KAAK,CAAC,KAAK,CAAC,WAAW,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;QAC5C,KAAK,CAAC,KAAK,CAAC,WAAW,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;QAC5C,KAAK,CAAC,KAAK,CAAC,WAAW,CAAC,aAAa,EAAE,KAAK,CAAC,CAAC;QAC9C,KAAK,CAAC,KAAK,CAAC,WAAW,CAAC,cAAc,EAAE,KAAK,CAAC,CAAC;QAE/C,IAAI,QAAQ,CAAC,aAAa,CAAC,UAAU,CAAC,EAAE;YACpC,KAAK,CAAC,KAAK,CAAC,WAAW,CAAC,iBAAiB,EAAE,MAAM,CAAC,CAAC;SACtD;aAAM;YACH,KAAK,CAAC,KAAK,CAAC,WAAW,CAAC,iBAAiB,EAAE,KAAK,CAAC,CAAC;YAClD,KAAK,CAAC,KAAK,CAAC,WAAW,CAAC,cAAc,EAAE,6BAA6B,CAAC,CAAC;SAC1E;KACJ;IAED,eAAe;QACX,MAAM,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;QACnE,IAAI,KAAK,EAAE;YACP,KAAK,CAAC,KAAK,EAAE,CAAC;SACjB;KACJ;CACJ,CAAA;;YA9HyB,QAAQ;YACP,YAAY;YACZ,UAAU;YACJ,eAAe;YACpB,wBAAwB;YACjB,iBAAiB;;AAQhD;IADC,SAAS,CAAC,2BAA2B,EAAE,EAAC,IAAI,EAAE,gBAAgB,EAAE,MAAM,EAAE,IAAI,EAAC,CAAC;yDAC3B;AAGpD;IADC,KAAK,EAAE;sCACO;AAKf;IADC,KAAK,EAAE;qCAIP;AASD;IADC,KAAK,EAAE;qCA4CP;AA/EQ,MAAM;IANlB,SAAS,CAAC;QACP,QAAQ,EAAE,aAAa;QACvB,eAAe,EAAE,uBAAuB,CAAC,MAAM;QAC/C,srBAA0B;;KAE7B,CAAC;GACW,MAAM,CAiIlB;;ICxJY,gBAAgB,GAA7B,MAAa,gBAAgB;IAEzB,YAAsB,eAAgC;QAAhC,oBAAe,GAAf,eAAe,CAAiB;KACrD;IAEK,MAAM,CAAC,OAAsB;;YAE/B,OAAO,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,OAAO,EAAE;gBAC1D,SAAS,EAAE,MAAM;gBACjB,cAAc,EAAE;oBACZ,MAAM,EAAE,OAAO,CAAC,MAAM;oBACtB,OAAO,EAAE,OAAO,CAAC,OAAO;oBACxB,OAAO,EAAE,OAAO,CAAC,OAAO;iBAC3B;aACJ,CAAC,CAAC,CAAC;SACP;KAAA;;;;IAKD,OAAO,CAAC,IAAU,EAAE,IAAa,EAAE,EAAW;QAC1C,OAAO,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,IAAI,EAAE,IAAI,EAAE,EAAE,CAAC,CAAC;KACvD;CAEJ,CAAA;;YAtB0C,eAAe;;AAF7C,gBAAgB;IAD5B,UAAU,EAAE;GACA,gBAAgB,CAwB5B;;ICTY,YAAY,GAAzB,MAAa,YAAY;CACxB,CAAA;AADY,YAAY;IANxB,QAAQ,CAAC;QACN,YAAY,EAAE,CAAC,MAAM,CAAC;QACtB,OAAO,EAAE,CAAC,UAAU,EAAE,WAAW,EAAE,YAAY,EAAE,aAAa,CAAC;QAC/D,eAAe,EAAE,CAAC,MAAM,CAAC;QACzB,SAAS,EAAE,CAAC,gBAAgB,CAAC;KAChC,CAAC;GACW,YAAY,CACxB;;ACtBD;;GAEG;;;;"}