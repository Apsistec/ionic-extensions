!function(e,s){"object"==typeof exports&&"undefined"!=typeof module?s(exports,require("@angular/core"),require("@co.mmons/ionic-extensions/lazy-image")):"function"==typeof define&&define.amd?define("@co.mmons/ionic-extensions/image-loader",["exports","@angular/core","@co.mmons/ionic-extensions/lazy-image"],s):s(((e=e||self).co=e.co||{},e.co.mmons=e.co.mmons||{},e.co.mmons["ionic-extensions"]=e.co.mmons["ionic-extensions"]||{},e.co.mmons["ionic-extensions"]["image-loader"]={}),e.ng.core,e.lazyImage)}(this,(function(e,s,t){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function r(e,s,t,r){var o,n=arguments.length,a=n<3?s:null===r?r=Object.getOwnPropertyDescriptor(s,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,s,t,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(n<3?o(a):n>3?o(s,t,a):o(s,t))||a);return n>3&&a&&Object.defineProperty(s,t,a),a}function o(e,s){var t,r,o,n,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function i(n){return function(i){return function(n){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,r&&(o=2&n[0]?r.return:n[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,n[1])).done)return o;switch(r=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,r=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=s.call(e,a)}catch(e){n=[6,e],r=0}finally{t=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,i])}}}var n=function(){function e(e){this.element=e}return Object.defineProperty(e.prototype,"src",{get:function(){return this._src},set:function(e){var s=this._src;this._src=e,s!=this._src&&this.reload()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"src2",{set:function(e){this.src=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alternate",{set:function(e){var s=this._alternate;this._alternate=e,s!=this._alternate&&this.reload()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alternate2",{set:function(e){this.alternate=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cssClasses",{set:function(e){this._cssClasses=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cssClasses2",{set:function(e){this._cssClasses=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cssClassesTarget",{set:function(e){this._cssClassesTarget=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cssClassesParent",{set:function(e){this._cssClassesTarget=e},enumerable:!0,configurable:!0}),e.prototype.reload=function(){if(!this.loading&&this.initialized){if(this.loaded=!1,this.error=!1,this._cssClasses){var e=this._cssClassesTarget?this.element.nativeElement.closest(this._cssClassesTarget):this.element.nativeElement;this._cssClasses.loaded&&e.classList.remove(this._cssClasses.loaded),this._cssClasses.error&&e.classList.remove(this._cssClasses.error)}this.load()}},e.prototype.load=function(){var e=this;if(!this.loaded&&!this.error&&this._src&&!this.loading){this.loading=!0,this._cssClasses&&this._cssClasses.loading&&this.element.nativeElement.classList.add(this._cssClasses.loading);var s,t=this.element.nativeElement;(s="img"!=t.tagName.toLowerCase()?this.tmpImg=new Image:t).onload=function(){if(s!==t&&(t.style.backgroundImage="url("+s.src+")"),s.onerror=void 0,s.onload=void 0,e.tmpImg=void 0,e.loaded=!0,e.loading=!1,e.error=!1,e._cssClasses){var r=e._cssClassesTarget?t.closest(e._cssClassesTarget):t;r&&(e._cssClasses.loading&&r.classList.remove(e._cssClasses.loading),e._cssClasses.loaded&&r.classList.add(e._cssClasses.loaded))}},s.onerror=function(){if(e._alternate&&e._alternate!=s.src)s.src=e._alternate;else if(s.onerror=void 0,s.onload=void 0,e.tmpImg=void 0,e.loading=!1,e.loaded=!1,e.error=!0,e._cssClasses){var r=e._cssClassesTarget?t.closest(e._cssClassesTarget):t;r&&(e._cssClasses.loading&&r.classList.remove(e._cssClasses.loading),e._cssClasses.error&&r.classList.add(e._cssClasses.error))}},s.src=this._src}},e.prototype.ngAfterViewInit=function(){this.initialized=!0,this.element.nativeElement.ionxImageLoader=this,this.load()},e.prototype.ngOnDestroy=function(){this.element.nativeElement&&delete this.element.nativeElement.ionxImageLoader},e.ctorParameters=function(){return[{type:s.ElementRef}]},r([s.Input("src")],e.prototype,"src",null),r([s.Input("ionx-image-loader")],e.prototype,"src2",null),r([s.Input("alternate")],e.prototype,"alternate",null),r([s.Input("ionx-image-loader-alternate")],e.prototype,"alternate2",null),r([s.Input("css-classes")],e.prototype,"cssClasses",null),r([s.Input("ionx-image-loader-css-classes")],e.prototype,"cssClasses2",null),r([s.Input("css-classes-target")],e.prototype,"cssClassesTarget",null),r([s.Input("ionx-image-loader-css-classes-target")],e.prototype,"cssClassesParent",null),e=r([s.Directive({selector:"[ionx-image-loader]",host:{"[attr.ionx-image-loader]":"true"}})],e)}();var a=function(){function e(){}return e=r([s.NgModule({declarations:[n],exports:[n]})],e)}();e.ImageLoader=n,e.ImageLoaderModule=a,e.ensureImagesLoaded=function(e,s){return r=this,n=void 0,i=function(){var r,n,a;return o(this,(function(o){switch(o.label){case 0:for(r=e.querySelectorAll("[ionx-image-loader]"),n=0;n<r.length;n++)(a=r.item(n)).ionxImageLoader&&a.ionxImageLoader.src&&!a.ionxImageLoader.loaded&&(!a.ionxImageLoader.error||s&&s.retryError)&&a.ionxImageLoader.reload();return s&&s.lazy?[4,t.ensureLazyImagesLoaded(e,{retryError:s&&s.retryError})]:[3,2];case 1:o.sent(),o.label=2;case 2:return[2]}}))},new((a=void 0)||(a=Promise))((function(e,s){function t(e){try{l(i.next(e))}catch(e){s(e)}}function o(e){try{l(i.throw(e))}catch(e){s(e)}}function l(s){s.done?e(s.value):new a((function(e){e(s.value)})).then(t,o)}l((i=i.apply(r,n||[])).next())}));var r,n,a,i},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=image-loader-module.umd.min.js.map