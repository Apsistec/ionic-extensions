export function findScrollParent(element) {
    if (!element) {
        return;
    }
    if (element.scrollHeight >= element.clientHeight) {
        var overflowY = window.getComputedStyle(element).overflowY;
        if (overflowY !== "visible" && overflowY !== "hidden") {
            return element;
        }
    }
    if (element.assignedSlot) {
        var p = findScrollParent(element.assignedSlot.parentElement);
        if (p) {
            return p;
        }
    }
    return findScrollParent(element.parentElement);
}
export function scrollIntoView(element, parent) {
    if (parent) {
        var parentRect = parent.getBoundingClientRect();
        var rect = element.getBoundingClientRect();
        if (!(rect.top > parentRect.top && rect.top <= parentRect.bottom && rect.bottom < parentRect.height)) {
            var top_1 = element.offsetTop;
            if (element.offsetParent) {
                var offsetParent = element.offsetParent;
                while (offsetParent !== parent && !!offsetParent) {
                    top_1 += offsetParent.offsetTop;
                    offsetParent = offsetParent.offsetParent;
                }
            }
            parent.scrollTo({ top: top_1 - 100 });
        }
        return;
    }
    element.scrollIntoView();
}
export function scrollToCaret(parent) {
    if (parent) {
        var parentRect = parent.getBoundingClientRect();
        var rect = caretTopPoint();
        if (!(rect.top > parentRect.top && rect.top <= parentRect.bottom)) {
            var top_2 = rect.top - parentRect.top;
            parent.scrollTo({ top: top_2, behavior: "auto" });
        }
        return;
    }
}
export function caretTopPoint() {
    var selection = document.getSelection();
    var range0 = selection.getRangeAt(0);
    var rect;
    var range;
    // supposed to be textNode in most cases
    // but div[contenteditable] when empty
    var node = range0.startContainer;
    var offset = range0.startOffset;
    if (offset > 0) {
        // new range, don't influence DOM state
        range = document.createRange();
        range.setStart(node, (offset - 1));
        range.setEnd(node, offset);
        // https://developer.mozilla.org/en-US/docs/Web/API/range.getBoundingClientRect
        // IE9, Safari?(but look good in Safari 8)
        rect = range.getBoundingClientRect();
        return { left: rect["right"], top: rect.top };
    }
    else if (offset < node["length"]) {
        range = document.createRange();
        // similar but select next on letter
        range.setStart(node, offset);
        range.setEnd(node, (offset + 1));
        rect = range.getBoundingClientRect();
        return { left: rect.left, top: rect.top };
    }
    else {
        // textNode has length
        // https://developer.mozilla.org/en-US/docs/Web/API/Element.getBoundingClientRect
        rect = node.getBoundingClientRect();
        var styles = getComputedStyle(node);
        var lineHeight = parseInt(styles.lineHeight);
        var fontSize = parseInt(styles.fontSize);
        // roughly half the whitespace... but not exactly
        var delta = (lineHeight - fontSize) / 2;
        return { left: rect.left, top: (rect.top + delta) };
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2Nyb2xsLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGNvLm1tb25zL2lvbmljLWV4dGVuc2lvbnMvaHRtbC1lZGl0b3IvIiwic291cmNlcyI6WyJzY3JvbGwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTSxVQUFVLGdCQUFnQixDQUFDLE9BQW9CO0lBRWpELElBQUksQ0FBQyxPQUFPLEVBQUU7UUFDVixPQUFPO0tBQ1Y7SUFFRCxJQUFJLE9BQU8sQ0FBQyxZQUFZLElBQUksT0FBTyxDQUFDLFlBQVksRUFBRTtRQUM5QyxJQUFNLFNBQVMsR0FBRyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxDQUFDLENBQUMsU0FBUyxDQUFDO1FBQzdELElBQUksU0FBUyxLQUFLLFNBQVMsSUFBSSxTQUFTLEtBQUssUUFBUSxFQUFFO1lBQ25ELE9BQU8sT0FBTyxDQUFDO1NBQ2xCO0tBQ0o7SUFFRCxJQUFJLE9BQU8sQ0FBQyxZQUFZLEVBQUU7UUFDdEIsSUFBTSxDQUFDLEdBQUcsZ0JBQWdCLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxhQUFhLENBQUMsQ0FBQztRQUMvRCxJQUFJLENBQUMsRUFBRTtZQUNILE9BQU8sQ0FBQyxDQUFDO1NBQ1o7S0FDSjtJQUVELE9BQU8sZ0JBQWdCLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxDQUFDO0FBQ25ELENBQUM7QUFFRCxNQUFNLFVBQVUsY0FBYyxDQUFDLE9BQW9CLEVBQUUsTUFBbUI7SUFFcEUsSUFBSSxNQUFNLEVBQUU7UUFFUixJQUFNLFVBQVUsR0FBRyxNQUFNLENBQUMscUJBQXFCLEVBQUUsQ0FBQztRQUNsRCxJQUFNLElBQUksR0FBRyxPQUFPLENBQUMscUJBQXFCLEVBQUUsQ0FBQztRQUU3QyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxHQUFHLFVBQVUsQ0FBQyxHQUFHLElBQUksSUFBSSxDQUFDLEdBQUcsSUFBSSxVQUFVLENBQUMsTUFBTSxJQUFJLElBQUksQ0FBQyxNQUFNLEdBQUcs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LEVBQUMsQ0FBQztLQUUzQztTQUFNO1FBQ0gsc0JBQXNCO1FBRXRCLGlGQUFpRjtRQUNqRixJQUFJLEdBQUcsSUFBSSxDQUFDLHFCQUFxQixFQUFFLENBQUM7UUFDcEMsSUFBTSxNQUFNLEdBQUcsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDdEMsSUFBTSxVQUFVLEdBQUcsUUFBUSxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUMvQyxJQUFNLFFBQVEsR0FBRyxRQUFRLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBRTNDLGlEQUFpRDtRQUNqRCxJQUFNLEtBQUssR0FBRyxDQUFDLFVBQVUsR0FBRyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUM7UUFFMUMsT0FBTyxFQUFDLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxHQUFHLEdBQUcsS0FBSyxDQUFDLEVBQUMsQ0FBQztLQUNyRDtBQUVMLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZnVuY3Rpb24gZmluZFNjcm9sbFBhcmVudChlbGVtZW50OiBIVE1MRWxlbWVudCk6IEhUTUxFbGVtZW50IHtcblxuICAgIGlmICghZWxlbWVudCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGVsZW1lbnQuc2Nyb2xsSGVpZ2h0ID49IGVsZW1lbnQuY2xpZW50SGVpZ2h0KSB7XG4gICAgICAgIGNvbnN0IG92ZXJmbG93WSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQpLm92ZXJmbG93WTtcbiAgICAgICAgaWYgKG92ZXJmbG93WSAhPT0gXCJ2aXNpYmxlXCIgJiYgb3ZlcmZsb3dZICE9PSBcImhpZGRlblwiKSB7XG4gICAgICAgICAgICByZXR1cm4gZWxlbWVudDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmIChlbGVtZW50LmFzc2lnbmVkU2xvdCkge1xuICAgICAgICBjb25zdCBwID0gZmluZFNjcm9sbFBhcmVudChlbGVtZW50LmFzc2lnbmVkU2xvdC5wYXJlbnRFbGVtZW50KTtcbiAgICAgICAgaWYgKHApIHtcbiAgICAgICAgICAgIHJldHVybiBwO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGZpbmRTY3JvbGxQYXJlbnQoZWxlbWVudC5wYXJlbnRFbGVtZW50KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNjcm9sbEludG9WaWV3KGVsZW1lbnQ6IEhUTUxFbGVtZW50LCBwYXJlbnQ6IEhUTUxFbGVtZW50KSB7XG5cbiAgICBpZiAocGFyZW50KSB7XG5cbiAgICAgICAgY29uc3QgcGFyZW50UmVjdCA9IHBhcmVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgY29uc3QgcmVjdCA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cbiAgICAgICAgaWYgKCEocmVjdC50b3AgPiBwYXJlbnRSZWN0LnRvcCAmJiByZWN0LnRvcCA8PSBwYXJlbnRSZWN0LmJvdHRvbSAmJiByZWN0LmJvdHRvbSA8IHBhcmVudFJlY3QuaGVpZ2h0KSkge1xuXG4gICAgICAgICAgICBsZXQgdG9wID0gZWxlbWVudC5vZmZzZXRUb3A7XG5cbiAgICAgICAgICAgIGlmIChlbGVtZW50Lm9mZnNldFBhcmVudCkge1xuICAgICAgICAgICAgICAgIGxldCBvZmZzZXRQYXJlbnQgPSBlbGVtZW50Lm9mZnNldFBhcmVudCBhcyBIVE1MRWxlbWVudDtcbiAgICAgICAgICAgICAgICB3aGlsZSAob2Zmc2V0UGFyZW50ICE9PSBwYXJlbnQgJiYgISFvZmZzZXRQYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgdG9wICs9IG9mZnNldFBhcmVudC5vZmZzZXRUb3A7XG4gICAgICAgICAgICAgICAgICAgIG9mZnNldFBhcmVudCA9IG9mZnNldFBhcmVudC5vZmZzZXRQYXJlbnQgYXMgSFRNTEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBwYXJlbnQuc2Nyb2xsVG8oe3RvcDogdG9wIC0gMTAwfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgZWxlbWVudC5zY3JvbGxJbnRvVmlldygpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2Nyb2xsVG9DYXJldChwYXJlbnQ6IEhUTUxFbGVtZW50KSB7XG5cbiAgICBpZiAocGFyZW50KSB7XG5cbiAgICAgICAgY29uc3QgcGFyZW50UmVjdCA9IHBhcmVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgY29uc3QgcmVjdCA9IGNhcmV0VG9wUG9pbnQoKTtcblxuICAgICAgICBpZiAoIShyZWN0LnRvcCA+IHBhcmVudFJlY3QudG9wICYmIHJlY3QudG9wIDw9IHBhcmVudFJlY3QuYm90dG9tKSkge1xuXG4gICAgICAgICAgICBsZXQgdG9wID0gcmVjdC50b3AgLSBwYXJlbnRSZWN0LnRvcDtcbiAgICAgICAgICAgIHBhcmVudC5zY3JvbGxUbyh7dG9wOiB0b3AsIGJlaGF2aW9yOiBcImF1dG9cIn0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxufVxuXG5leHBvcnQgZnVuY3Rpb24gY2FyZXRUb3BQb2ludCgpOiB7bGVmdDogbnVtYmVyLCB0b3A6IG51bWJlcn0ge1xuXG4gICAgY29uc3Qgc2VsZWN0aW9uID0gZG9jdW1lbnQuZ2V0U2VsZWN0aW9uKCk7XG4gICAgY29uc3QgcmFuZ2UwID0gc2VsZWN0aW9uLmdldFJhbmdlQXQoMCk7XG5cbiAgICBsZXQgcmVjdDoge2xlZnQ6IG51bWJlciwgdG9wOiBudW1iZXJ9O1xuICAgIGxldCByYW5nZTogUmFuZ2U7XG5cbiAgICAvLyBzdXBwb3NlZCB0byBiZSB0ZXh0Tm9kZSBpbiBtb3N0IGNhc2VzXG4gICAgLy8gYnV0IGRpdltjb250ZW50ZWRpdGFibGVdIHdoZW4gZW1wdHlcbiAgICBjb25zdCBub2RlID0gcmFuZ2UwLnN0YXJ0Q29udGFpbmVyIGFzIEVsZW1lbnQ7XG5cbiAgICBjb25zdCBvZmZzZXQgPSByYW5nZTAuc3RhcnRPZmZzZXQ7XG4gICAgaWYgKG9mZnNldCA+IDApIHtcblxuICAgICAgICAvLyBuZXcgcmFuZ2UsIGRvbid0IGluZmx1ZW5jZSBET00gc3RhdGVcbiAgICAgICAgcmFuZ2UgPSBkb2N1bWVudC5jcmVhdGVSYW5nZSgpO1xuICAgICAgICByYW5nZS5zZXRTdGFydChub2RlLCAob2Zmc2V0IC0gMSkpO1xuICAgICAgICByYW5nZS5zZXRFbmQobm9kZSwgb2Zmc2V0KTtcblxuICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvcmFuZ2UuZ2V0Qm91bmRpbmdDbGllbnRSZWN0XG4gICAgICAgIC8vIElFOSwgU2FmYXJpPyhidXQgbG9vayBnb29kIGluIFNhZmFyaSA4KVxuICAgICAgICByZWN0ID0gcmFuZ2UuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cbiAgICAgICAgcmV0dXJuIHtsZWZ0OiByZWN0W1wicmlnaHRcIl0sIHRvcDogcmVjdC50b3B9O1xuXG4gICAgfSBlbHNlIGlmIChvZmZzZXQgPCBub2RlW1wibGVuZ3RoXCJdKSB7XG5cbiAgICAgICAgcmFuZ2UgPSBkb2N1bWVudC5jcmVhdGVSYW5nZSgpO1xuICAgICAgICAvLyBzaW1pbGFyIGJ1dCBzZWxlY3QgbmV4dCBvbiBsZXR0ZXJcbiAgICAgICAgcmFuZ2Uuc2V0U3RhcnQobm9kZSwgb2Zmc2V0KTtcbiAgICAgICAgcmFuZ2Uuc2V0RW5kKG5vZGUsIChvZmZzZXQgKyAxKSk7XG4gICAgICAgIHJlY3QgPSByYW5nZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgICAgICByZXR1cm4ge2xlZnQ6IHJlY3QubGVmdCwgdG9wOiByZWN0LnRvcH07XG5cbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyB0ZXh0Tm9kZSBoYXMgbGVuZ3RoXG5cbiAgICAgICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0VsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0XG4gICAgICAgIHJlY3QgPSBub2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICBjb25zdCBzdHlsZXMgPSBnZXRDb21wdXRlZFN0eWxlKG5vZGUpO1xuICAgICAgICBjb25zdCBsaW5lSGVpZ2h0ID0gcGFyc2VJbnQoc3R5bGVzLmxpbmVIZWlnaHQpO1xuICAgICAgICBjb25zdCBmb250U2l6ZSA9IHBhcnNlSW50KHN0eWxlcy5mb250U2l6ZSk7XG5cbiAgICAgICAgLy8gcm91Z2hseSBoYWxmIHRoZSB3aGl0ZXNwYWNlLi4uIGJ1dCBub3QgZXhhY3RseVxuICAgICAgICBjb25zdCBkZWx0YSA9IChsaW5lSGVpZ2h0IC0gZm9udFNpemUpIC8gMjtcblxuICAgICAgICByZXR1cm4ge2xlZnQ6IHJlY3QubGVmdCwgdG9wOiAocmVjdC50b3AgKyBkZWx0YSl9O1xuICAgIH1cblxufVxuIl19