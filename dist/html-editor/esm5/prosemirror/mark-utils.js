export var isMarkAllowedInRange = function (doc, ranges, type) {
    var _loop_1 = function (i) {
        var _a = ranges[i], $from = _a.$from, $to = _a.$to;
        var can = $from.depth === 0 ? doc.type.allowsMarkType(type) : false;
        doc.nodesBetween($from.pos, $to.pos, function (node) {
            if (can) {
                return false;
            }
            can = node.inlineContent && node.type.allowsMarkType(type);
            return;
        });
        if (can) {
            return { value: can };
        }
    };
    for (var i = 0; i < ranges.length; i++) {
        var state_1 = _loop_1(i);
        if (typeof state_1 === "object")
            return state_1.value;
    }
    return false;
};
export var isMarkExcluded = function (type, marks) {
    if (marks) {
        return marks.some(function (mark) { return mark.type !== type && mark.type.excludes(type); });
    }
    return false;
};
var not = function (fn) { return function (arg) { return !fn(arg); }; };
var ɵ0 = not;
export var removeBlockMarks = function (state, marks) {
    var selection = state.selection, schema = state.schema;
    var tr = state.tr;
    // Marks might not exist in Schema
    var marksToRemove = marks.filter(Boolean);
    if (marksToRemove.length === 0) {
        return undefined;
    }
    /** Saves an extra dispatch */
    var blockMarksExists = false;
    var hasMark = function (mark) { return marksToRemove.indexOf(mark.type) > -1; };
    /**
     * When you need to toggle the selection
     * when another type which does not allow alignment is applied
     */
    state.doc.nodesBetween(selection.from, selection.to, function (node, pos) {
        if (node.type === schema.nodes.paragraph && node.marks.some(hasMark)) {
            blockMarksExists = true;
            var resolvedPos = state.doc.resolve(pos);
            var withoutBlockMarks = node.marks.filter(not(hasMark));
            tr = tr.setNodeMarkup(resolvedPos.pos, undefined, node.attrs, withoutBlockMarks);
        }
    });
    return blockMarksExists ? tr : undefined;
};
/**
 * Removes marks from nodes in the current selection that are not supported
 */
export var sanitizeSelectionMarks = function (state) {
    var tr;
    var _a = state.tr.selection, $from = _a.$from, $to = _a.$to;
    state.doc.nodesBetween($from.pos, $to.pos, function (node, pos) {
        node.marks.forEach(function (mark) {
            if (!node.type.allowsMarkType(mark.type)) {
                var filteredMarks = node.marks.filter(function (m) { return m.type !== mark.type; });
                var position = pos > 0 ? pos - 1 : 0;
                tr = (tr || state.tr).setNodeMarkup(position, undefined, node.attrs, filteredMarks);
            }
        });
    });
    return tr;
};
export { ɵ0 };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFyay11dGlscy5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bjby5tbW9ucy9pb25pYy1leHRlbnNpb25zL2h0bWwtZWRpdG9yLyIsInNvdXJjZXMiOlsicHJvc2VtaXJyb3IvbWFyay11dGlscy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFHQSxNQUFNLENBQUMsSUFBTSxvQkFBb0IsR0FBRyxVQUNoQyxHQUFTLEVBQ1QsTUFBNkIsRUFDN0IsSUFBYzs0QkFFTCxDQUFDO1FBQ0EsSUFBQSxjQUEwQixFQUF4QixnQkFBSyxFQUFFLFlBQWlCLENBQUM7UUFDakMsSUFBSSxHQUFHLEdBQUcsS0FBSyxDQUFDLEtBQUssS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUM7UUFDcEUsR0FBRyxDQUFDLFlBQVksQ0FBQyxLQUFLLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxHQUFHLEVBQUUsVUFBQSxJQUFJO1lBQ3JDLElBQUksR0FBRyxFQUFFO2dCQUNMLE9BQU8sS0FBSyxDQUFDO2FBQ2hCO1lBQ0QsR0FBRyxHQUFHLElBQUksQ0FBQyxhQUFhLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDM0QsT0FBTztRQUNYLENBQUMsQ0FBQyxDQUFDO1FBQ0gsSUFBSSxHQUFHLEVBQUU7NEJBQ0UsR0FBRztTQUNiOztJQVpMLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxNQUFNLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRTs4QkFBN0IsQ0FBQzs7O0tBYVQ7SUFDRCxPQUFPLEtBQUssQ0FBQztBQUNqQixDQUFDLENBQUM7QUFFRixNQUFNLENBQUMsSUFBTSxjQUFjLEdBQUcsVUFDMUIsSUFBYyxFQUNkLEtBQTBCO0lBRTFCLElBQUksS0FBSyxFQUFFO1FBQ1AsT0FBTyxLQUFLLENBQUMs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R0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUN2QyxFQUFFLEdBQUcsQ0FBQyxFQUFFLElBQUksS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUFDLGFBQWEsQ0FDL0IsUUFBUSxFQUNSLFNBQVMsRUFDVCxJQUFJLENBQUMsS0FBSyxFQUNWLGFBQWEsQ0FDaEIsQ0FBQzthQUNMO1FBQ0wsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDLENBQUMsQ0FBQztJQUNILE9BQU8sRUFBRSxDQUFDO0FBQ2QsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTm9kZSwgTWFyaywgTWFya1R5cGUgfSBmcm9tIFwicHJvc2VtaXJyb3ItbW9kZWxcIjtcbmltcG9ydCB7IFNlbGVjdGlvblJhbmdlLCBFZGl0b3JTdGF0ZSwgVHJhbnNhY3Rpb24gfSBmcm9tIFwicHJvc2VtaXJyb3Itc3RhdGVcIjtcblxuZXhwb3J0IGNvbnN0IGlzTWFya0FsbG93ZWRJblJhbmdlID0gKFxuICAgIGRvYzogTm9kZSxcbiAgICByYW5nZXM6IEFycmF5PFNlbGVjdGlvblJhbmdlPixcbiAgICB0eXBlOiBNYXJrVHlwZSxcbik6IGJvb2xlYW4gPT4ge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmFuZ2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHsgJGZyb20sICR0byB9ID0gcmFuZ2VzW2ldO1xuICAgICAgICBsZXQgY2FuID0gJGZyb20uZGVwdGggPT09IDAgPyBkb2MudHlwZS5hbGxvd3NNYXJrVHlwZSh0eXBlKSA6IGZhbHNlO1xuICAgICAgICBkb2Mubm9kZXNCZXR3ZWVuKCRmcm9tLnBvcywgJHRvLnBvcywgbm9kZSA9PiB7XG4gICAgICAgICAgICBpZiAoY2FuKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FuID0gbm9kZS5pbmxpbmVDb250ZW50ICYmIG5vZGUudHlwZS5hbGxvd3NNYXJrVHlwZSh0eXBlKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChjYW4pIHtcbiAgICAgICAgICAgIHJldHVybiBjYW47XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufTtcblxuZXhwb3J0IGNvbnN0IGlzTWFya0V4Y2x1ZGVkID0gKFxuICAgIHR5cGU6IE1hcmtUeXBlLFxuICAgIG1hcmtzPzogQXJyYXk8TWFyaz4gfCBudWxsLFxuKTogYm9vbGVhbiA9PiB7XG4gICAgaWYgKG1hcmtzKSB7XG4gICAgICAgIHJldHVybiBtYXJrcy5zb21lKG1hcmsgPT4gbWFyay50eXBlICE9PSB0eXBlICYmIG1hcmsudHlwZS5leGNsdWRlcyh0eXBlKSk7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn07XG5cbmNvbnN0IG5vdCA9IDxUPihmbjogKChhcmdzOiBUKSA9PiBib29sZWFuKSkgPT4gKGFyZzogVCkgPT4gIWZuKGFyZyk7XG5cbmV4cG9ydCBjb25zdCByZW1vdmVCbG9ja01hcmtzID0gKFxuICAgIHN0YXRlOiBFZGl0b3JTdGF0ZSxcbiAgICBtYXJrczogQXJyYXk8TWFya1R5cGUgfCB1bmRlZmluZWQ+LFxuKTogVHJhbnNhY3Rpb24gfCB1bmRlZmluZWQgPT4ge1xuICAgIGNvbnN0IHsgc2VsZWN0aW9uLCBzY2hlbWEgfSA9IHN0YXRlO1xuICAgIGxldCB7IHRyIH0gPSBzdGF0ZTtcblxuICAgIC8vIE1hcmtzIG1pZ2h0IG5vdCBleGlzdCBpbiBTY2hlbWFcbiAgICBjb25zdCBtYXJrc1RvUmVtb3ZlID0gbWFya3MuZmlsdGVyKEJvb2xlYW4pO1xuICAgIGlmIChtYXJrc1RvUmVtb3ZlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIC8qKiBTYXZlcyBhbiBleHRyYSBkaXNwYXRjaCAqL1xuICAgIGxldCBibG9ja01hcmtzRXhpc3RzID0gZmFsc2U7XG5cbiAgICBjb25zdCBoYXNNYXJrID0gKG1hcms6IE1hcmspID0+IG1hcmtzVG9SZW1vdmUuaW5kZXhPZihtYXJrLnR5cGUpID4gLTE7XG4gICAgLyoqXG4gICAgICogV2hlbiB5b3UgbmVlZCB0byB0b2dnbGUgdGhlIHNlbGVjdGlvblxuICAgICAqIHdoZW4gYW5vdGhlciB0eXBlIHdoaWNoIGRvZXMgbm90IGFsbG93IGFsaWdubWVudCBpcyBhcHBsaWVkXG4gICAgICovXG4gICAgc3RhdGUuZG9jLm5vZGVzQmV0d2VlbihzZWxlY3Rpb24uZnJvbSwgc2VsZWN0aW9uLnRvLCAobm9kZSwgcG9zKSA9PiB7XG4gICAgICAgIGlmIChub2RlLnR5cGUgPT09IHNjaGVtYS5ub2Rlcy5wYXJhZ3JhcGggJiYgbm9kZS5tYXJrcy5zb21lKGhhc01hcmspKSB7XG4gICAgICAgICAgICBibG9ja01hcmtzRXhpc3RzID0gdHJ1ZTtcbiAgICAgICAgICAgIGNvbnN0IHJlc29sdmVkUG9zID0gc3RhdGUuZG9jLnJlc29sdmUocG9zKTtcbiAgICAgICAgICAgIGNvbnN0IHdpdGhvdXRCbG9ja01hcmtzID0gbm9kZS5tYXJrcy5maWx0ZXIobm90KGhhc01hcmspKTtcbiAgICAgICAgICAgIHRyID0gdHIuc2V0Tm9kZU1hcmt1cChcbiAgICAgICAgICAgICAgICByZXNvbHZlZFBvcy5wb3MsXG4gICAgICAgICAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIG5vZGUuYXR0cnMsXG4gICAgICAgICAgICAgICAgd2l0aG91dEJsb2NrTWFya3MsXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIGJsb2NrTWFya3NFeGlzdHMgPyB0ciA6IHVuZGVmaW5lZDtcbn07XG5cbi8qKlxuICogUmVtb3ZlcyBtYXJrcyBmcm9tIG5vZGVzIGluIHRoZSBjdXJyZW50IHNlbGVjdGlvbiB0aGF0IGFyZSBub3Qgc3VwcG9ydGVkXG4gKi9cbmV4cG9ydCBjb25zdCBzYW5pdGl6ZVNlbGVjdGlvbk1hcmtzID0gKFxuICAgIHN0YXRlOiBFZGl0b3JTdGF0ZSxcbik6IFRyYW5zYWN0aW9uIHwgdW5kZWZpbmVkID0+IHtcbiAgICBsZXQgdHI6IFRyYW5zYWN0aW9uIHwgdW5kZWZpbmVkO1xuICAgIGNvbnN0IHsgJGZyb20sICR0byB9ID0gc3RhdGUudHIuc2VsZWN0aW9uO1xuICAgIHN0YXRlLmRvYy5ub2Rlc0JldHdlZW4oJGZyb20ucG9zLCAkdG8ucG9zLCAobm9kZSwgcG9zKSA9PiB7XG4gICAgICAgIG5vZGUubWFya3MuZm9yRWFjaChtYXJrID0+IHtcbiAgICAgICAgICAgIGlmICghbm9kZS50eXBlLmFsbG93c01hcmtUeXBlKG1hcmsudHlwZSkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWx0ZXJlZE1hcmtzID0gbm9kZS5tYXJrcy5maWx0ZXIobSA9PiBtLnR5cGUgIT09IG1hcmsudHlwZSk7XG4gICAgICAgICAgICAgICAgY29uc3QgcG9zaXRpb24gPSBwb3MgPiAwID8gcG9zIC0gMSA6IDA7XG4gICAgICAgICAgICAgICAgdHIgPSAodHIgfHwgc3RhdGUudHIpLnNldE5vZGVNYXJrdXAoXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uLFxuICAgICAgICAgICAgICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgIG5vZGUuYXR0cnMsXG4gICAgICAgICAgICAgICAgICAgIGZpbHRlcmVkTWFya3MsXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRyO1xufTtcbiJdfQ==