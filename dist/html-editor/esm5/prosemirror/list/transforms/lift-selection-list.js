import { getListLiftTarget } from "../utils/get-list-lift-target";
// The function will list paragraphs in selection out to level 1 below root list.
export function liftSelectionList(state, tr) {
    var _a = state.selection, from = _a.from, to = _a.to;
    var paragraph = state.schema.nodes.paragraph;
    var listCol = [];
    tr.doc.nodesBetween(from, to, function (node, pos) {
        if (node.type === paragraph) {
            listCol.push({ node: node, pos: pos });
        }
    });
    for (var i = listCol.length - 1; i >= 0; i--) {
        var paragraph_1 = listCol[i];
        var start = tr.doc.resolve(tr.mapping.map(paragraph_1.pos));
        if (start.depth > 0) {
            var end = void 0;
            if (paragraph_1.node.textContent && paragraph_1.node.textContent.length > 0) {
                end = tr.doc.resolve(tr.mapping.map(paragraph_1.pos + paragraph_1.node.textContent.length));
            }
            else {
                end = tr.doc.resolve(tr.mapping.map(paragraph_1.pos + 1));
            }
            var range = start.blockRange(end);
            if (range) {
                tr.lift(range, getListLiftTarget(state.schema, start));
            }
        }
    }
    return tr;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGlmdC1zZWxlY3Rpb24tbGlzdC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bjby5tbW9ucy9pb25pYy1leHRlbnNpb25zL2h0bWwtZWRpdG9yLyIsInNvdXJjZXMiOlsicHJvc2VtaXJyb3IvbGlzdC90cmFuc2Zvcm1zL2xpZnQtc2VsZWN0aW9uLWxpc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxFQUFDLGlCQUFpQixFQUFDLE1BQU0sK0JBQStCLENBQUM7QUFFaEUsaUZBQWlGO0FBQ2pGLE1BQU0sVUFBVSxpQkFBaUIsQ0FDN0IsS0FBa0IsRUFDbEIsRUFBZTtJQUVULElBQUEsb0JBQTRCLEVBQTNCLGNBQUksRUFBRSxVQUFxQixDQUFDO0lBQzVCLElBQUEsd0NBQVMsQ0FBdUI7SUFDdkMsSUFBTSxPQUFPLEdBQVUsRUFBRSxDQUFDO0lBQzFCLEVBQUUsQ0FBQyxHQUFHLENBQUMsWUFBWSxDQUFDLElBQUksRUFBRSxFQUFFLEVBQUUsVUFBQyxJQUFJLEVBQUUsR0FBRztRQUNwQyxJQUFJLElBQUksQ0FBQyxJQUFJLEtBQUssU0FBUyxFQUFFO1lBQ3pCLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFBQyxJQUFJLE1BQUEsRUFBRSxHQUFHLEtBQUEsRUFBQyxDQUFDLENBQUM7U0FDN0I7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUNILEtBQUssSUFBSSxDQUFDLEdBQUcsT0FBTyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRTtRQUMxQyxJQUFNLFdBQVMsR0FBRyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDN0IsSUFBTSxLQUFLLEdBQUcsRUFBRSxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsV0FBUyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDNUQsSUFBSSxLQUFLLENBQUMsS0FBSyxHQUFHLENBQUMsRUFBRTtZQUNqQixJQUFJLEdBQUcsU0FBQSxDQUFDO1lBQ1IsSUFBSSxXQUFTLENBQUMsSUFBSSxDQUFDLFdBQVcsSUFBSSxXQUFTLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO2dCQUNyRSxHQUFHLEdBQUcsRUFBRSxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQ2hCLEVBQUUsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLFdBQVMsQ0FBQyxHQUFHLEdBQUcsV0FBUyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLENBQ3BFLENBQUM7YUFDTDtpQkFBTTtnQkFDSCxHQUFHLEdBQUcsRUFBRSxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsV0FBUyxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO2FBQzNEO1lBQ0QsSUFBTSxLQUFLLEdBQUcsS0FBSyxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUNwQyxJQUFJLEtBQUssRUFBRTtnQkFDUCxFQUFFLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsTUFBTSxFQUFFLEtBQUssQ0FBQyxDQUFDLENBQUM7YUFDMUQ7U0FDSjtLQUNKO0lBQ0QsT0FBTyxFQUFFLENBQUM7QUFDZCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtFZGl0b3JTdGF0ZSwgVHJhbnNhY3Rpb259IGZyb20gXCJwcm9zZW1pcnJvci1zdGF0ZVwiO1xuaW1wb3J0IHtnZXRMaXN0TGlmdFRhcmdldH0gZnJvbSBcIi4uL3V0aWxzL2dldC1saXN0LWxpZnQtdGFyZ2V0XCI7XG5cbi8vIFRoZSBmdW5jdGlvbiB3aWxsIGxpc3QgcGFyYWdyYXBocyBpbiBzZWxlY3Rpb24gb3V0IHRvIGxldmVsIDEgYmVsb3cgcm9vdCBsaXN0LlxuZXhwb3J0IGZ1bmN0aW9uIGxpZnRTZWxlY3Rpb25MaXN0KFxuICAgIHN0YXRlOiBFZGl0b3JTdGF0ZSxcbiAgICB0cjogVHJhbnNhY3Rpb24sXG4pOiBUcmFuc2FjdGlvbiB7XG4gICAgY29uc3Qge2Zyb20sIHRvfSA9IHN0YXRlLnNlbGVjdGlvbjtcbiAgICBjb25zdCB7cGFyYWdyYXBofSA9IHN0YXRlLnNjaGVtYS5ub2RlcztcbiAgICBjb25zdCBsaXN0Q29sOiBhbnlbXSA9IFtdO1xuICAgIHRyLmRvYy5ub2Rlc0JldHdlZW4oZnJvbSwgdG8sIChub2RlLCBwb3MpID0+IHtcbiAgICAgICAgaWYgKG5vZGUudHlwZSA9PT0gcGFyYWdyYXBoKSB7XG4gICAgICAgICAgICBsaXN0Q29sLnB1c2goe25vZGUsIHBvc30pO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgZm9yIChsZXQgaSA9IGxpc3RDb2wubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgY29uc3QgcGFyYWdyYXBoID0gbGlzdENvbFtpXTtcbiAgICAgICAgY29uc3Qgc3RhcnQgPSB0ci5kb2MucmVzb2x2ZSh0ci5tYXBwaW5nLm1hcChwYXJhZ3JhcGgucG9zKSk7XG4gICAgICAgIGlmIChzdGFydC5kZXB0aCA+IDApIHtcbiAgICAgICAgICAgIGxldCBlbmQ7XG4gICAgICAgICAgICBpZiAocGFyYWdyYXBoLm5vZGUudGV4dENvbnRlbnQgJiYgcGFyYWdyYXBoLm5vZGUudGV4dENvbnRlbnQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGVuZCA9IHRyLmRvYy5yZXNvbHZlKFxuICAgICAgICAgICAgICAgICAgICB0ci5tYXBwaW5nLm1hcChwYXJhZ3JhcGgucG9zICsgcGFyYWdyYXBoLm5vZGUudGV4dENvbnRlbnQubGVuZ3RoKSxcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBlbmQgPSB0ci5kb2MucmVzb2x2ZSh0ci5tYXBwaW5nLm1hcChwYXJhZ3JhcGgucG9zICsgMSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgcmFuZ2UgPSBzdGFydC5ibG9ja1JhbmdlKGVuZCk7XG4gICAgICAgICAgICBpZiAocmFuZ2UpIHtcbiAgICAgICAgICAgICAgICB0ci5saWZ0KHJhbmdlLCBnZXRMaXN0TGlmdFRhcmdldChzdGF0ZS5zY2hlbWEsIHN0YXJ0KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRyO1xufVxuIl19