{"version":3,"file":"form-helper-module.js","sources":["ng://@co.mmons/ionic-extensions/form-helper/heading.ts","ng://@co.mmons/ionic-extensions/form-helper/helper.ts","ng://@co.mmons/ionic-extensions/form-helper/item.ts","ng://@co.mmons/ionic-extensions/form-helper/item-error.ts","ng://@co.mmons/ionic-extensions/form-helper/item-hint.ts","ng://@co.mmons/ionic-extensions/form-helper/index.ts","ng://@co.mmons/ionic-extensions/form-helper/form-helper-module.ts"],"sourcesContent":["import {Component, HostBinding, Input} from \"@angular/core\";\n\n@Component({\n    selector: \"ionx-form-heading\",\n    template: `\n        <ng-content select=\"ion-item\"></ng-content>\n        <div ionx--under>\n            <ng-content></ng-content>\n        </div>\n    `,\n    styleUrls: [\"heading.scss\"]\n})\nexport class FormHeading {\n\n    constructor() {\n    }\n\n    @HostBinding(\"attr.sticky\")\n    @Input()\n    sticky: boolean;\n}\n","import {ContentChildren, Directive, ElementRef, Input, Optional, QueryList} from \"@angular/core\";\nimport {FormControlName, FormGroup, FormGroupDirective, NgForm} from \"@angular/forms\";\nimport {scrollIntoView} from \"@co.mmons/ionic-extensions/scroll\";\n\n@Directive({\n    selector: \"[ionx-form-helper], [ionxFormHelper]\",\n    exportAs: \"ionxFormHelper\"\n})\nexport class FormHelper {\n\n    constructor(public readonly element: ElementRef, @Optional() public readonly ngForm: NgForm, @Optional() private readonly formGroupDirective: FormGroupDirective) {\n    }\n\n    @Input()\n    public get readonly(): boolean {\n        return this.element.nativeElement.hasAttribute(\"readonly\");\n    }\n\n    public set readonly(readonly: boolean) {\n        if (readonly) {\n            this.element.nativeElement.setAttribute(\"readonly\", \"\");\n        } else {\n            this.element.nativeElement.removeAttribute(\"readonly\");\n        }\n    }\n\n    public markAsReadonly() {\n        this.readonly = true;\n    }\n\n    @Input()\n    public get busy(): boolean {\n        return this.element.nativeElement.hasAttribute(\"busy\");\n    }\n\n    public set busy(busy: boolean) {\n        if (busy) {\n            this.element.nativeElement.setAttribute(\"busy\", \"\");\n        } else {\n            this.element.nativeElement.removeAttribute(\"busy\");\n        }\n    }\n\n    public markAsBusy() {\n        this.busy = true;\n    }\n\n    @ContentChildren(FormControlName, {descendants: true})\n    protected readonly contentControls: QueryList<FormControlName>;\n\n    public formControlName(name: string): FormControlName {\n\n        for (let a of this.contentControls.toArray()) {\n            if (a.name == name) {\n                return a;\n            }\n        }\n    }\n\n    public get formGroup(): FormGroup {\n        return this.formGroupDirective ? this.formGroupDirective.form : undefined;\n    }\n\n    public validateAll(markAs: \"touched\" | \"dirty\" = \"touched\") {\n\n        if (!this.formGroupDirective) {\n            return;\n        }\n\n        for (let controlName in this.formGroup.controls) {\n            let control = this.formGroup.controls[controlName];\n\n            if (markAs == \"touched\") {\n                control.markAsTouched();\n            }\n\n            if (markAs == \"dirty\") {\n                control.markAsDirty();\n            }\n\n            control.updateValueAndValidity();\n        }\n\n        for (let control of this.contentControls.toArray()) {\n            if (!control.valid) {\n                this.focusImpl(control);\n                break;\n            }\n        }\n    }\n\n    private focusImpl(control: string | any, scroll: boolean = true) {\n\n        if (typeof control == \"string\" && this.formGroupDirective) {\n            for (let c of this.formGroupDirective.directives) {\n                if (c.name == control) {\n                    control = c;\n                    break;\n                }\n            }\n        }\n\n        let element: HTMLElement;\n\n        if (control instanceof FormControlName) {\n            control = control.valueAccessor;\n        }\n\n        if (control[\"el\"] instanceof ElementRef) {\n            element = control[\"el\"].nativeElement;\n        }\n\n        if (control[\"_elementRef\"] instanceof ElementRef) {\n            element = control[\"_elementRef\"].nativeElement;\n        }\n\n        // element to focus\n        if (element) {\n\n            if (element[\"setFocus\"]) {\n                element[\"setFocus\"]();\n\n            } else {\n\n                let focusable = element;\n\n                let realInput = (element.shadowRoot && element.shadowRoot.querySelector(\".native-input\")) || element.querySelector(\".native-input\");\n                if (realInput) {\n                    focusable = realInput as HTMLElement;\n                }\n\n                focusable.focus();\n            }\n        }\n\n        if (scroll && element) {\n            scrollIntoView(element.closest(\"ion-item\") as HTMLElement || element);\n        }\n    }\n\n    public focus(formControlName: string, scrollIntoView: boolean = true) {\n        this.focusImpl(formControlName, scrollIntoView);\n    }\n}\n","import {Component} from \"@angular/core\";\n\n@Component({\n    selector: \"ionx-form-item\",\n    styleUrls: [\"item.scss\"],\n    template: `<ng-content select=\"ion-item\"></ng-content><ng-content select=\"ionx-form-item-error\"></ng-content><ng-content select=\"ionx-form-item-hint\"></ng-content><ng-content></ng-content>`\n})\nexport class FormItem {\n\n}\n","import {Component, Input} from \"@angular/core\";\nimport {AbstractControl, FormGroupDirective} from \"@angular/forms\";\n\n@Component({\n    selector: \"ionx-form-item-error\",\n    template: `\n        <ion-icon [name]=\"icon\" *ngIf=\"!!icon\"></ion-icon>\n        <label>\n            <ng-template [ngIf]=\"_control\">{{_control | intlValidationErrorMessage}}</ng-template>\n            <ng-content></ng-content>\n        </label>\n    `,\n    styleUrls: [\"item-error-item-hint.scss\", \"item-error.scss\"],\n    host: {\n        \"[class.ionx--visible]\": \"!_control || !!(_control.invalid && _control[markedAs])\"\n    }\n})\nexport class FormItemError {\n\n    constructor(private formGroup: FormGroupDirective) {\n    }\n\n    @Input()\n    icon: string;\n\n    @Input()\n    markedAs: \"touched\" | \"dirty\" = \"touched\";\n\n    _control: AbstractControl;\n\n    @Input()\n    set control(control: AbstractControl | string) {\n        if (control instanceof AbstractControl) {\n            this._control = control;\n        } else if (control) {\n            this._control = this.formGroup.form.controls[control];\n        }\n    }\n\n}\n","import {Component, ComponentRef, Input, ViewChild, ViewContainerRef} from \"@angular/core\";\n\n@Component({\n    selector: \"ionx-form-item-hint\",\n    styleUrls: [\"item-error-item-hint.scss\", \"item-hint.scss\"],\n    template: `\n        <ion-icon [name]=\"icon\" *ngIf=\"icon\"></ion-icon>\n        <label>\n            <template #labelComponentContainer></template>\n            <ng-content></ng-content>\n        </label>\n    `\n    })\nexport class FormItemHint {\n\n    constructor() {\n    }\n\n    @Input()\n    icon: string;\n\n    @ViewChild(\"labelComponentContainer\", {read: ViewContainerRef, static: true})\n    private labelComponentContainer: ViewContainerRef;\n\n    @Input()\n    set label(label: ComponentRef<any>) {\n        this.labelComponentContainer.clear();\n        this.labelComponentContainer.insert(label.hostView);\n    }\n}\n","import {CommonModule} from \"@angular/common\";\nimport {NgModule} from \"@angular/core\";\nimport {FormsModule} from \"@angular/forms\";\nimport {MatchMediaModule} from \"@co.mmons/angular-extensions/browser/match-media\";\nimport {IntlModule} from \"@co.mmons/angular-intl\";\nimport {IonicModule} from \"@ionic/angular\";\nimport {FormHeading} from \"./heading\";\nimport {FormHelper} from \"./helper\";\nimport {FormItem} from \"./item\";\nimport {FormItemError} from \"./item-error\";\nimport {FormItemHint} from \"./item-hint\";\n\nexport * from \"./heading\";\nexport * from \"./helper\";\nexport * from \"./item\";\nexport * from \"./item-error\";\nexport * from \"./item-hint\";\n\n@NgModule({\n    declarations: [FormItem, FormHeading, FormItemError, FormItemHint, FormHelper],\n    imports: [CommonModule, FormsModule, IonicModule, IntlModule, MatchMediaModule],\n    exports: [FormItem, FormItemError, FormItemHint, FormHeading, FormHelper]\n})\nexport class FormHelperModule {\n}","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":["tslib_1.__decorate","tslib_1.__param"],"mappings":";;;;;;;;;IAYa,WAAW,GAAxB,MAAa,WAAW;IAEpB;KACC;CAKJ,CAAA;AADGA;IAFC,WAAW,CAAC,aAAa,CAAC;IAC1B,KAAK,EAAE;2CACQ;AAPP,WAAW;IAVvB,SAAS,CAAC;QACP,QAAQ,EAAE,mBAAmB;QAC7B,QAAQ,EAAE;;;;;KAKT;;KAEJ,CAAC;GACW,WAAW,CAQvB;;ICZY,UAAU,GAAvB,MAAa,UAAU;IAEnB,YAA4B,OAAmB,EAA8B,MAAc,EAA+B,kBAAsC;QAApI,YAAO,GAAP,OAAO,CAAY;QAA8B,WAAM,GAAN,MAAM,CAAQ;QAA+B,uBAAkB,GAAlB,kBAAkB,CAAoB;KAC/J;IAGD,IAAW,QAAQ;QACf,OAAO,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;KAC9D;IAED,IAAW,QAAQ,CAAC,QAAiB;QACjC,IAAI,QAAQ,EAAE;YACV,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,YAAY,CAAC,UAAU,EAAE,EAAE,CAAC,CAAC;SAC3D;aAAM;YACH,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,eAAe,CAAC,UAAU,CAAC,CAAC;SAC1D;KACJ;IAEM,cAAc;QACjB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;KACxB;IAGD,IAAW,IAAI;QACX,OAAO,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC;KAC1D;IAED,IAAW,IAAI,CAAC,IAAa;QACzB,IAAI,IAAI,EAAE;YACN,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,YAAY,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;SACvD;aAAM;YACH,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;SACtD;KACJ;IAEM,UAAU;QACb,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;KACpB;IAKM,eAAe,CAAC,IAAY;QAE/B,KAAK,IAAI,CAAC,IAAI,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,EAAE;YAC1C,IAAI,CAAC,CAAC,IAAI,IAAI,IAAI,EAAE;gBAChB,OAAO,CAAC,CAAC;aACZ;SACJ;KACJ;IAED,IAAW,SAAS;QAChB,OAAO,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,kBAAkB,CAAC,IAAI,GAAG,SAAS,CAAC;KAC7E;IAEM,WAAW,CAAC,SAA8B,SAAS;QAEtD,IAAI,CAAC,IAAI,CAAC,kBAAkB,EAAE;YAC1B,OAAO;SACV;QAED,KAAK,IAAI,WAAW,IAAI,IAAI,CAAC,SAAS,CAAC,QAAQ,EAAE;YAC7C,IAAI,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;YAEnD,IAAI,MAAM,IAAI,SAAS,EAAE;gBACrB,OAAO,CAAC,aAAa,EAAE,CAAC;aAC3B;YAED,IAAI,MAAM,IAAI,OAAO,EAAE;gBACnB,OAAO,CAAC,WAAW,EAAE,CAAC;aACzB;YAED,OAAO,CAAC,sBAAsB,EAAE,CAAC;SACpC;QAED,KAAK,IAAI,OAAO,IAAI,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,EAAE;YAChD,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE;gBAChB,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;gBACxB,MAAM;aACT;SACJ;KACJ;IAEO,SAAS,CAAC,OAAqB,EAAE,SAAkB,IAAI;QAE3D,IAAI,OAAO,OAAO,IAAI,QAAQ,IAAI,IAAI,CAAC,kBAAkB,EAAE;YACvD,KAAK,IAAI,CAAC,IAAI,IAAI,CAAC,kBAAkB,CAAC,UAAU,EAAE;gBAC9C,IAAI,CAAC,CAAC,IAAI,IAAI,OAAO,EAAE;oBACnB,OAAO,GAAG,CAAC,CAAC;oBACZ,MAAM;iBACT;aACJ;SACJ;QAED,IAAI,OAAoB,CAAC;QAEzB,IAAI,OAAO,YAAY,eAAe,EAAE;YACpC,OAAO,GAAG,OAAO,CAAC,aAAa,CAAC;SACnC;QAED,IAAI,OAAO,CAAC,IAAI,CAAC,YAAY,UAAU,EAAE;YACrC,OAAO,GAAG,OAAO,CAAC,IAAI,CAAC,CAAC,aAAa,CAAC;SACzC;QAED,IAAI,OAAO,CAAC,aAAa,CAAC,YAAY,UAAU,EAAE;YAC9C,OAAO,GAAG,OAAO,CAAC,aAAa,CAAC,CAAC,aAAa,CAAC;SAClD;;QAGD,IAAI,OAAO,EAAE;YAET,IAAI,OAAO,CAAC,UAAU,CAAC,EAAE;gBACrB,OAAO,CAAC,UAAU,CAAC,EAAE,CAAC;aAEzB;iBAAM;gBAEH,IAAI,SAAS,GAAG,OAAO,CAAC;gBAExB,IAAI,SAAS,GAAG,CAAC,OAAO,CAAC,UAAU,IAAI,OAAO,CAAC,UAAU,CAAC,aAAa,CAAC,eAAe,CAAC,KAAK,OAAO,CAAC,aAAa,CAAC,eAAe,CAAC,CAAC;gBACpI,IAAI,SAAS,EAAE;oBACX,SAAS,GAAG,SAAwB,CAAC;iBACxC;gBAED,SAAS,CAAC,KAAK,EAAE,CAAC;aACrB;SACJ;QAED,IAAI,MAAM,IAAI,OAAO,EAAE;YACnB,cAAc,CAAC,OAAO,CAAC,OAAO,CAAC,UAAU,CAAgB,IAAI,OAAO,CAAC,CAAC;SACzE;KACJ;IAEM,KAAK,CAAC,eAAuB,EAAE,iBAA0B,IAAI;QAChE,IAAI,CAAC,SAAS,CAAC,eAAe,EAAE,cAAc,CAAC,CAAC;KACnD;CACJ,CAAA;;YArIwC,UAAU;YAAsC,MAAM,uBAAzC,QAAQ;YAAoF,kBAAkB,uBAAlE,QAAQ;;AAItGA;IADC,KAAK,EAAE;0CAGP;AAeDA;IADC,KAAK,EAAE;sCAGP;AAeDA;IADC,eAAe,CAAC,eAAe,EAAE,EAAC,WAAW,EAAE,IAAI,EAAC,CAAC;mDACS;AAxCtD,UAAU;IAJtB,SAAS,CAAC;QACP,QAAQ,EAAE,sCAAsC;QAChD,QAAQ,EAAE,gBAAgB;KAC7B,CAAC;IAGoDC,WAAA,QAAQ,EAAE,CAAA,EAAkCA,WAAA,QAAQ,EAAE,CAAA;GAF/F,UAAU,CAuItB;;ICxIY,QAAQ,GAArB,MAAa,QAAQ;CAEpB,CAAA;AAFY,QAAQ;IALpB,SAAS,CAAC;QACP,QAAQ,EAAE,gBAAgB;QAE1B,QAAQ,EAAE,mLAAmL;;KAChM,CAAC;GACW,QAAQ,CAEpB;;ICQY,aAAa,GAA1B,MAAa,aAAa;IAEtB,YAAoB,SAA6B;QAA7B,cAAS,GAAT,SAAS,CAAoB;QAOjD,aAAQ,GAAwB,SAAS,CAAC;KANzC;IAWD,IAAI,OAAO,CAAC,OAAiC;QACzC,IAAI,OAAO,YAAY,eAAe,EAAE;YACpC,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC;SAC3B;aAAM,IAAI,OAAO,EAAE;YAChB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;SACzD;KACJ;CAEJ,CAAA;;YApBkC,kBAAkB;;AAIjDD;IADC,KAAK,EAAE;2CACK;AAGbA;IADC,KAAK,EAAE;+CACkC;AAK1CA;IADC,KAAK,EAAE;4CAOP;AApBQ,aAAa;IAdzB,SAAS,CAAC;QACP,QAAQ,EAAE,sBAAsB;QAChC,QAAQ,EAAE;;;;;;KAMT;QAED,IAAI,EAAE;YACF,uBAAuB,EAAE,yDAAyD;SACrF;;KACJ,CAAC;GACW,aAAa,CAsBzB;;IC1BY,YAAY,GAAzB,MAAa,YAAY;IAErB;KACC;IASD,IAAI,KAAK,CAAC,KAAwB;QAC9B,IAAI,CAAC,uBAAuB,CAAC,KAAK,EAAE,CAAC;QACrC,IAAI,CAAC,uBAAuB,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;KACvD;CACJ,CAAA;AAVGA;IADC,KAAK,EAAE;0CACK;AAGbA;IADC,SAAS,CAAC,yBAAyB,EAAE,EAAC,IAAI,EAAE,gBAAgB,EAAE,MAAM,EAAE,IAAI,EAAC,CAAC;6DAC3B;AAGlDA;IADC,KAAK,EAAE;yCAIP;AAfQ,YAAY;IAXxB,SAAS,CAAC;QACP,QAAQ,EAAE,qBAAqB;QAE/B,QAAQ,EAAE;;;;;;KAMT;;KACA,CAAC;GACO,YAAY,CAgBxB;;ICNY,gBAAgB,GAA7B,MAAa,gBAAgB;CAC5B,CAAA;AADY,gBAAgB;IAL5B,QAAQ,CAAC;QACN,YAAY,EAAE,CAAC,QAAQ,EAAE,WAAW,EAAE,aAAa,EAAE,YAAY,EAAE,UAAU,CAAC;QAC9E,OAAO,EAAE,CAAC,YAAY,EAAE,WAAW,EAAE,WAAW,EAAE,UAAU,EAAE,gBAAgB,CAAC;QAC/E,OAAO,EAAE,CAAC,QAAQ,EAAE,aAAa,EAAE,YAAY,EAAE,WAAW,EAAE,UAAU,CAAC;KAC5E,CAAC;GACW,gBAAgB,CAC5B;;ACxBD;;GAEG;;;;"}