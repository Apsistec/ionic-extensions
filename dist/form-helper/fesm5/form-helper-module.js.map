{"version":3,"file":"form-helper-module.js","sources":["ng://@co.mmons/ionic-extensions/form-helper/heading.ts","ng://@co.mmons/ionic-extensions/form-helper/helper.ts","ng://@co.mmons/ionic-extensions/form-helper/item.ts","ng://@co.mmons/ionic-extensions/form-helper/item-error.ts","ng://@co.mmons/ionic-extensions/form-helper/item-hint.ts","ng://@co.mmons/ionic-extensions/form-helper/index.ts","ng://@co.mmons/ionic-extensions/form-helper/form-helper-module.ts"],"sourcesContent":["import {Component, HostBinding, Input} from \"@angular/core\";\n\n@Component({\n    selector: \"ionx-form-heading\",\n    template: `\n        <ng-content select=\"ion-item\"></ng-content>\n        <div ionx--under>\n            <ng-content></ng-content>\n        </div>\n    `,\n    styleUrls: [\"heading.scss\"]\n})\nexport class FormHeading {\n\n    constructor() {\n    }\n\n    @HostBinding(\"attr.sticky\")\n    @Input()\n    sticky: boolean;\n}\n","import {ContentChildren, Directive, ElementRef, Input, Optional, QueryList} from \"@angular/core\";\nimport {FormControlName, FormGroup, FormGroupDirective, NgForm} from \"@angular/forms\";\nimport {scrollIntoView} from \"@co.mmons/ionic-extensions/scroll\";\n\n@Directive({\n    selector: \"[ionx-form-helper], [ionxFormHelper]\",\n    exportAs: \"ionxFormHelper\"\n})\nexport class FormHelper {\n\n    constructor(public readonly element: ElementRef, @Optional() public readonly ngForm: NgForm, @Optional() private readonly formGroupDirective: FormGroupDirective) {\n    }\n\n    @Input()\n    public get readonly(): boolean {\n        return this.element.nativeElement.hasAttribute(\"readonly\");\n    }\n\n    public set readonly(readonly: boolean) {\n        if (readonly) {\n            this.element.nativeElement.setAttribute(\"readonly\", \"\");\n        } else {\n            this.element.nativeElement.removeAttribute(\"readonly\");\n        }\n    }\n\n    public markAsReadonly() {\n        this.readonly = true;\n    }\n\n    @Input()\n    public get busy(): boolean {\n        return this.element.nativeElement.hasAttribute(\"busy\");\n    }\n\n    public set busy(busy: boolean) {\n        if (busy) {\n            this.element.nativeElement.setAttribute(\"busy\", \"\");\n        } else {\n            this.element.nativeElement.removeAttribute(\"busy\");\n        }\n    }\n\n    public markAsBusy() {\n        this.busy = true;\n    }\n\n    @ContentChildren(FormControlName, {descendants: true})\n    protected readonly contentControls: QueryList<FormControlName>;\n\n    public formControlName(name: string): FormControlName {\n\n        for (let a of this.contentControls.toArray()) {\n            if (a.name == name) {\n                return a;\n            }\n        }\n    }\n\n    public get formGroup(): FormGroup {\n        return this.formGroupDirective ? this.formGroupDirective.form : undefined;\n    }\n\n    public validateAll(markAs: \"touched\" | \"dirty\" = \"touched\") {\n\n        if (!this.formGroupDirective) {\n            return;\n        }\n\n        for (let controlName in this.formGroup.controls) {\n            let control = this.formGroup.controls[controlName];\n\n            if (markAs == \"touched\") {\n                control.markAsTouched();\n            }\n\n            if (markAs == \"dirty\") {\n                control.markAsDirty();\n            }\n\n            control.updateValueAndValidity();\n        }\n\n        for (let control of this.contentControls.toArray()) {\n            if (!control.valid) {\n                this.focusImpl(control);\n                break;\n            }\n        }\n    }\n\n    private focusImpl(control: string | any, scroll: boolean = true) {\n\n        if (typeof control == \"string\" && this.formGroupDirective) {\n            for (let c of this.formGroupDirective.directives) {\n                if (c.name == control) {\n                    control = c;\n                    break;\n                }\n            }\n        }\n\n        let element: HTMLElement;\n\n        if (control instanceof FormControlName) {\n            control = control.valueAccessor;\n        }\n\n        if (control[\"el\"] instanceof ElementRef) {\n            element = control[\"el\"].nativeElement;\n        }\n\n        if (control[\"_elementRef\"] instanceof ElementRef) {\n            element = control[\"_elementRef\"].nativeElement;\n        }\n\n        // element to focus\n        if (element) {\n\n            if (element[\"setFocus\"]) {\n                element[\"setFocus\"]();\n\n            } else {\n\n                let focusable = element;\n\n                let realInput = (element.shadowRoot && element.shadowRoot.querySelector(\".native-input\")) || element.querySelector(\".native-input\");\n                if (realInput) {\n                    focusable = realInput as HTMLElement;\n                }\n\n                focusable.focus();\n            }\n        }\n\n        if (scroll && element) {\n            scrollIntoView(element.closest(\"ion-item\") as HTMLElement || element);\n        }\n    }\n\n    public focus(formControlName: string, scrollIntoView: boolean = true) {\n        this.focusImpl(formControlName, scrollIntoView);\n    }\n}\n","import {Component} from \"@angular/core\";\n\n@Component({\n    selector: \"ionx-form-item\",\n    styleUrls: [\"item.scss\"],\n    template: `<ng-content select=\"ion-item\"></ng-content><ng-content select=\"ionx-form-item-error\"></ng-content><ng-content select=\"ionx-form-item-hint\"></ng-content><ng-content></ng-content>`\n})\nexport class FormItem {\n\n}\n","import {Component, Input} from \"@angular/core\";\nimport {AbstractControl, FormGroupDirective} from \"@angular/forms\";\n\n@Component({\n    selector: \"ionx-form-item-error\",\n    template: `\n        <ion-icon [name]=\"icon\" *ngIf=\"!!icon\"></ion-icon>\n        <label>\n            <ng-template [ngIf]=\"control\">{{control | intlValidationErrorMessage}}</ng-template>\n            <ng-content></ng-content>\n        </label>\n    `,\n    styleUrls: [\"item-error-item-hint.scss\", \"item-error.scss\"],\n    host: {\n        \"[class.ionx--visible]\": \"!control || !!(control.invalid && control[markedAs])\"\n    }\n})\nexport class FormItemError {\n\n    constructor(private formGroup: FormGroupDirective) {\n    }\n\n    @Input()\n    icon: string;\n\n    @Input()\n    markedAs: \"touched\" | \"dirty\" = \"touched\";\n\n    private _control: AbstractControl | string;\n\n    get control() {\n        if (typeof this._control === \"string\") {\n            return this.formGroup.form && this.formGroup.form.controls[this._control];\n        } else {\n            return this._control;\n        }\n    }\n\n    @Input(\"control\")\n    set controlOrName(control: AbstractControl | string) {\n        this._control = control;\n    }\n\n}\n","import {Component, ComponentRef, Input, ViewChild, ViewContainerRef} from \"@angular/core\";\n\n@Component({\n    selector: \"ionx-form-item-hint\",\n    styleUrls: [\"item-error-item-hint.scss\", \"item-hint.scss\"],\n    template: `\n        <ion-icon [name]=\"icon\" *ngIf=\"icon\"></ion-icon>\n        <label>\n            <template #labelComponentContainer></template>\n            <ng-content></ng-content>\n        </label>\n    `\n    })\nexport class FormItemHint {\n\n    constructor() {\n    }\n\n    @Input()\n    icon: string;\n\n    @ViewChild(\"labelComponentContainer\", {read: ViewContainerRef, static: true})\n    private labelComponentContainer: ViewContainerRef;\n\n    @Input()\n    set label(label: ComponentRef<any>) {\n        this.labelComponentContainer.clear();\n        this.labelComponentContainer.insert(label.hostView);\n    }\n}\n","import {CommonModule} from \"@angular/common\";\nimport {NgModule} from \"@angular/core\";\nimport {FormsModule} from \"@angular/forms\";\nimport {MatchMediaModule} from \"@co.mmons/angular-extensions/browser/match-media\";\nimport {IntlModule} from \"@co.mmons/angular-intl\";\nimport {IonicModule} from \"@ionic/angular\";\nimport {FormHeading} from \"./heading\";\nimport {FormHelper} from \"./helper\";\nimport {FormItem} from \"./item\";\nimport {FormItemError} from \"./item-error\";\nimport {FormItemHint} from \"./item-hint\";\n\nexport * from \"./heading\";\nexport * from \"./helper\";\nexport * from \"./item\";\nexport * from \"./item-error\";\nexport * from \"./item-hint\";\n\n@NgModule({\n    declarations: [FormItem, FormHeading, FormItemError, FormItemHint, FormHelper],\n    imports: [CommonModule, FormsModule, IonicModule, IntlModule, MatchMediaModule],\n    exports: [FormItem, FormItemError, FormItemHint, FormHeading, FormHelper]\n})\nexport class FormHelperModule {\n}","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":["tslib_1.__decorate","tslib_1.__values","tslib_1.__param"],"mappings":"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"}