!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/cdk/scrolling"),require("@angular/common"),require("@angular/core"),require("@angular/forms"),require("@co.mmons/angular-extensions/browser/match-media"),require("@co.mmons/angular-intl"),require("@co.mmons/ionic-extensions/buttons"),require("@ionic/angular"),require("dragula"),require("@co.mmons/js-utils/core")):"function"==typeof define&&define.amd?define("@co.mmons/ionic-extensions/select",["exports","@angular/cdk/scrolling","@angular/common","@angular/core","@angular/forms","@co.mmons/angular-extensions/browser/match-media","@co.mmons/angular-intl","@co.mmons/ionic-extensions/buttons","@ionic/angular","dragula","@co.mmons/js-utils/core"],t):t(((e=e||self).co=e.co||{},e.co.mmons=e.co.mmons||{},e.co.mmons["ionic-extensions"]=e.co.mmons["ionic-extensions"]||{},e.co.mmons["ionic-extensions"].select={}),e.ng.cdk.scrolling,e.ng.common,e.ng.core,e.ng.forms,e.matchMedia,e.angularIntl,e.buttons,e.angular,e.dragula,e.core$1)}(this,(function(e,t,n,o,i,r,l,a,s,p,c){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var h=function(e,t){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function u(e,t,n,o){var i,r=arguments.length,l=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(l=(r<3?i(l):r>3?i(t,n,l):i(t,n))||l);return r>3&&l&&Object.defineProperty(t,n,l),l}function d(e,t){return function(n,o){t(n,o,e)}}function v(e,t,n,o){return new(n||(n=Promise))((function(i,r){function l(e){try{s(o.next(e))}catch(e){r(e)}}function a(e){try{s(o.throw(e))}catch(e){r(e)}}function s(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(l,a)}s((o=o.apply(e,t||[])).next())}))}function f(e,t){var n,o,i,r,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return l.label++,{value:r[1],done:!1};case 5:l.label++,o=r[1],r=[0];continue;case 7:r=l.ops.pop(),l.trys.pop();continue;default:if(!(i=(i=l.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){l=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){l.label=r[1];break}if(6===r[0]&&l.label<i[1]){l.label=i[1],i=r;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(r);break}i[2]&&l.ops.pop(),l.trys.pop();continue}r=t.call(e,l)}catch(e){r=[6,e],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}function m(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}var y=function(){function e(e,t){this.templateRef=e,this.viewContainer=t,this.separator=", "}return e.ctorParameters=function(){return[{type:o.TemplateRef},{type:o.ViewContainerRef}]},u([o.Input()],e.prototype,"separator",void 0),e=u([o.Directive({selector:"[ionxSelectLabel]"})],e)}(),b=function(){function e(e){this.element=e}return Object.defineProperty(e.prototype,"label",{get:function(){return this.element.nativeElement.innerText},enumerable:!0,configurable:!0}),e.ctorParameters=function(){return[{type:o.ElementRef}]},u([o.Input()],e.prototype,"value",void 0),u([o.Input()],e.prototype,"divider",void 0),e=u([o.Component({selector:"ionx-select-option",changeDetection:o.ChangeDetectionStrategy.OnPush,template:"<ng-content></ng-content>"})],e)}(),g=function(e){function t(){var n=e.call(this)||this;return Object.setPrototypeOf(n,t.prototype),n}return function(e,t){function n(){this.constructor=e}h(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype.pushOption=function(e,t,n){this.push({value:e,label:t,disabled:n})},t.prototype.pushDivider=function(e){this.push({divider:!0,label:e})},t}(Array),x=function(){function e(e,t,n,o){this.element=e,this.intl=t,this.popoverController=n,this.modalController=o,this.multiple=!1,this.whiteSpace="nowrap"}return Object.defineProperty(e.prototype,"popoverOverlay",{get:function(){return"popover"==this.overlay},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"modalOverlay",{get:function(){return"modal"==this.overlay},enumerable:!0,configurable:!0}),e.prototype.optionDivider=function(e,t,n){for(var o=0;o<this.options.length;o++)if(this.options[o]===e&&o>0&&this.options[o-1].divider)return this.options[o-1]},e.prototype.optionClicked=function(e,t){e.checked&&!this.empty&&1===this.checkedOptions.length&&this.checkedOptions[0]===e&&(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation())},e.prototype.optionBeforeChange=function(e){this.lastClickedOption=e,e.checkedTimestamp=Date.now()},e.prototype.optionChanged=function(e){var t,n,o,i,r,l,a,s,p,c;if(this.lastClickedOption&&e===this.lastClickedOption){if(this.multiple&&this.valueValidator){var h=[];try{for(var u=m(this.checkedOptions),d=u.next();!d.done;d=u.next()){(O=d.value)!==e&&h.push(O.value)}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}var v=e.checked;try{for(var f=m(this.options),y=f.next();!y.done;y=f.next()){(O=y.value).checked=!1}}catch(e){o={error:e}}finally{try{y&&!y.done&&(i=f.return)&&i.call(f)}finally{if(o)throw o.error}}this.checkedOptions=[];try{e:for(var b=m(this.valueValidator(e.value,v,h)||[]),g=b.next();!g.done;g=b.next()){var x=g.value;try{for(var w=(a=void 0,m(this.options)),C=w.next();!C.done;C=w.next()){var O=C.value;if(this.valueComparator(O.value,x)){O.checked=!0,this.checkedOptions.push(O);continue e}}}catch(e){a={error:e}}finally{try{C&&!C.done&&(s=w.return)&&s.call(w)}finally{if(a)throw a.error}}}}catch(e){r={error:e}}finally{try{g&&!g.done&&(l=b.return)&&l.call(b)}finally{if(r)throw r.error}}}else if(e.checked)if(this.multiple)this.checkedOptions.push(e);else{try{for(var k=m(this.options),I=k.next();!I.done;I=k.next()){(O=I.value).checked&&O!==e&&(O.checked=!1)}}catch(e){p={error:e}}finally{try{I&&!I.done&&(c=k.return)&&c.call(k)}finally{if(p)throw p.error}}this.checkedOptions=[e]}else for(var T=0;T<this.checkedOptions.length;T++)if(this.checkedOptions[T]===e){this.checkedOptions.splice(T,1);break}this.multiple||this.okClicked(),this.lastClickedOption=void 0}},e.prototype.buildVisibleOptions=function(){for(var e,t,n=0;n<this.options.length;n++)if(this.options[n].divider&&(this.options[n].hidden=!0,this.options.length-1>n))for(var o=n+1;o<this.options.length&&!this.options[o].divider;o++)if(!this.options[o].hidden){this.options[n].hidden=!1;break}this.visibleOptions=[];try{for(var i=m(this.options),r=i.next();!r.done;r=i.next()){var l=r.value;l.hidden||this.visibleOptions.push(l)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},e.prototype.initOptions=function(){return v(this,void 0,void 0,(function(){var e,t,n,o,i,r,l,a=this;return f(this,(function(s){switch(s.label){case 0:this.checkedOptions=[];try{for(e=m(this.options),t=e.next();!t.done;t=e.next())(n=t.value).checked&&this.checkedOptions.push(n)}catch(e){r={error:e}}finally{try{t&&!t.done&&(l=e.return)&&l.call(e)}finally{if(r)throw r.error}}return this.orderable&&this.checkedOptions.sort((function(e,t){return e.checkedTimestamp-t.checkedTimestamp})),this.buildVisibleOptions(),this.checkedOptions.length>0&&this.modalOverlay?[4,c.waitTill((function(){return!!a.scroll}))]:[3,2];case 1:for(s.sent(),o=-1,i=0;i<this.visibleOptions.length;i++)if(this.visibleOptions[i].checked){o=i;break}this.scroll.scrollToIndex(o),s.label=2;case 2:return[2]}}))}))},e.prototype.okClicked=function(){var e,t,n,o,i,r,l=[];if(this.orderable)try{for(var a=m(this.checkedOptions),s=a.next();!s.done;s=a.next()){var p=s.value;l.push(p.value)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}else try{e:for(var c=m(this.options),h=c.next();!h.done;h=c.next()){var u=h.value;try{for(var d=(i=void 0,m(this.checkedOptions)),v=d.next();!v.done;v=d.next()){var f=v.value;if(u===f){l.push(f.value);continue e}}}catch(e){i={error:e}}finally{try{v&&!v.done&&(r=d.return)&&r.call(d)}finally{if(i)throw i.error}}}}catch(e){n={error:e}}finally{try{h&&!h.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}this.updateValues(l),this.popoverController&&this.popoverOverlay?this.popoverController.dismiss():this.modalController&&this.modalOverlay&&this.modalController.dismiss()},e.prototype.cancelClicked=function(){this.popoverController&&this.popoverOverlay?this.popoverController.dismiss():this.modalController&&this.modalOverlay&&this.modalController.dismiss()},e.prototype.search=function(e){var t,n,o=this.searchbar.nativeElement.value?this.searchbar.nativeElement.value.toString():void 0;o&&(o=o.trim().toLowerCase());try{for(var i=m(this.options),r=i.next();!r.done;r=i.next()){var l=r.value;l.hidden=!!o&&(this.searchHandler?!this.searchHandler(o,l.value,l.label):(l.label||"").toLowerCase().indexOf(o)<0)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}this.buildVisibleOptions()},e.prototype.fixIosContentInPopover=function(){return v(this,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.content.nativeElement.getScrollElement()];case 1:return e.sent(),this.content.nativeElement.shadowRoot.appendChild(document.createElement("style")).innerText=".transition-effect { display: none !important }",[3,3];case 2:return e.sent(),[3,3];case 3:return[2]}}))}))},e.prototype.ngOnInit=function(){this.popoverOverlay?this.initOptions():this.element.nativeElement.closest("ion-modal").classList.contains("modal-ios")?this.itemHeight=44.55:this.itemHeight=49},e.prototype.ngAfterViewInit=function(){this.popoverOverlay&&this.fixIosContentInPopover()},e.prototype.resetScrollHeight=function(){return v(this,void 0,void 0,(function(){var e,t,n=this;return f(this,(function(o){switch(o.label){case 0:return e=this.scrollHeight,(t=this.content.nativeElement.offsetHeight)!=e?[3,2]:[4,c.waitTill((function(){return(t=n.content.nativeElement.offsetHeight)!==e}),void 0,2e3)];case 1:o.sent(),o.label=2;case 2:return this.scrollHeight=t,"number"!=typeof e&&this.scroll&&this.scroll.checkViewportSize(),[2]}}))}))},e.prototype.ionViewDidEnter=function(){return v(this,void 0,void 0,(function(){var e=this;return f(this,(function(t){switch(t.label){case 0:return this.modalOverlay?(this.resetScrollHeight(),window.cordova&&"browser"!==window.cordova.platformId?[3,2]:[4,c.waitTill((function(){return!!e.searchbar&&!!e.searchbar.nativeElement.querySelector("input")}))]):[3,3];case 1:t.sent(),this.searchbar.nativeElement.setFocus(),t.label=2;case 2:this.initOptions(),t.label=3;case 3:return[2]}}))}))},e.ctorParameters=function(){return[{type:o.ElementRef},{type:l.IntlService},{type:s.PopoverController,decorators:[{type:o.Optional}]},{type:s.ModalController,decorators:[{type:o.Optional}]}]},u([o.Input()],e.prototype,"overlay",void 0),u([o.ViewChild(t.CdkVirtualScrollViewport,{static:!1})],e.prototype,"scroll",void 0),u([o.ViewChild("content",{read:o.ElementRef,static:!0})],e.prototype,"content",void 0),u([o.Input()],e.prototype,"multiple",void 0),u([o.Input()],e.prototype,"orderable",void 0),u([o.Input()],e.prototype,"updateValues",void 0),u([o.Input()],e.prototype,"title",void 0),u([o.Input()],e.prototype,"searchHandler",void 0),u([o.Input()],e.prototype,"valueValidator",void 0),u([o.Input()],e.prototype,"valueComparator",void 0),u([o.Input()],e.prototype,"label",void 0),u([o.Input()],e.prototype,"options",void 0),u([o.Input()],e.prototype,"empty",void 0),u([o.Input()],e.prototype,"whiteSpace",void 0),u([o.ViewChild("searchbar",{read:o.ElementRef,static:!1})],e.prototype,"searchbar",void 0),u([o.HostListener("window:resize")],e.prototype,"resetScrollHeight",null),e=u([o.Component({selector:"ionx-select-overlay",template:'<ion-header *ngIf="modalOverlay">\n    <ion-toolbar>\n        <ion-title style="padding: 0px">{{title}}</ion-title>\n\n        <ionx-buttons slot="start">\n            <ion-back-button style="display: inline-block" [icon]="(\'tablet\' | matchGreaterWidth) ? \'close\' : null" (click)="$event.preventDefault(); cancelClicked()"></ion-back-button>\n        </ionx-buttons>\n\n        <ionx-buttons slot="end">\n            <ion-button fill="clear" (click)="okClicked()">{{"@co.mmons/js-intl#Done" | intlMessage}}</ion-button>\n        </ionx-buttons>\n\n    </ion-toolbar>\n    <ion-toolbar>\n        <ion-searchbar #searchbar cancelButtonText="{{\'@co.mmons/js-intl#Cancel\' | intlMessage}}" placeholder="{{\'@co.mmons/js-intl#Search\' | intlMessage}}"\n                       (ionInput)="search($event)"></ion-searchbar>\n    </ion-toolbar>\n</ion-header>\n<ion-content [scrollY]="false" [scrollX]="false" #content>\n\n    <div class="ionx-select-overlay-spinner" slot="fixed" *ngIf="!checkedOptions">\n        <ion-spinner></ion-spinner>\n    </div>\n\n    <ng-template [ngIf]="!!visibleOptions">\n        <div>\n\n            <cdk-virtual-scroll-viewport [itemSize]="itemHeight" [style.height.px]="scrollHeight" *ngIf="modalOverlay">\n\n                <ion-list lines="full">\n\n                    <ion-item detail="false" button="false" [style.fontWeight]="option.divider ? 500 : null" #listItem *cdkVirtualFor="let option of visibleOptions">\n                        <ion-checkbox [(ngModel)]="option.checked" (ngModelChange)="optionBeforeChange(option)" (ionChange)="optionChanged(option)" (click)="optionClicked(option, $event)" slot="start"\n                                      *ngIf="!option.divider"></ion-checkbox>\n                        <ion-label>\n                            <span *ngIf="!label; else customLabel">{{option.label}}</span>\n                            <ng-template #customLabel>\n                                <ng-container *ngTemplateOutlet="label.templateRef; context: {$implicit: option.value}"></ng-container>\n                            </ng-template>\n                        </ion-label>\n                    </ion-item>\n                </ion-list>\n\n            </cdk-virtual-scroll-viewport>\n\n            <ion-list lines="full" *ngIf="popoverOverlay">\n\n                <ng-template ngFor [ngForOf]="visibleOptions" let-option>\n\n                    <ion-item-divider *ngIf="option.divider; else basicOption">\n                        <ion-label>{{option.label}}</ion-label>\n                    </ion-item-divider>\n\n                    <ng-template #basicOption>\n\n                        <ion-item detail="false" button="false" #listItem>\n                            <ion-checkbox [(ngModel)]="option.checked" (ngModelChange)="optionBeforeChange(option)" (ionChange)="optionChanged(option)" (click)="optionClicked(option, $event)" slot="start"></ion-checkbox>\n                            <ion-label [style.whiteSpace]="whiteSpace">\n                                <span *ngIf="!label; else customLabel">{{option.label}}</span>\n                                <ng-template #customLabel>\n                                    <ng-container *ngTemplateOutlet="label.templateRef; context: {$implicit: option.value}"></ng-container>\n                                </ng-template>\n                            </ion-label>\n                        </ion-item>\n\n                    </ng-template>\n\n                </ng-template>\n            </ion-list>\n        </div>\n    </ng-template>\n\n</ion-content>\n\n<ion-footer *ngIf="multiple && popoverOverlay" style="position: sticky; bottom: 0px">\n    <ion-toolbar>\n        <ion-buttons slot="end">\n\n            <ion-button size="small" (click)="cancelClicked()">{{"@co.mmons/js-intl#Cancel" | intlMessage}}</ion-button>\n\n            <ion-button size="small" (click)="okClicked()">{{"@co.mmons/js-intl#Ok" | intlMessage}}</ion-button>\n\n        </ion-buttons>\n    </ion-toolbar>\n</ion-footer>\n',styles:["@media (min-width:768px){::ng-deep .ionx-select-overlay-width .popover-content{--width:300px;--max-width:90%}}@media (max-width:767px){::ng-deep .ionx-select-overlay-width .popover-content{left:calc(16px + var(--ion-safe-area-left,0px))!important;width:calc(100% - (32px + var(--ion-safe-area-right,0px) + var(--ion-safe-area-left,0px)))}}:host .ionx-select-overlay-spinner{position:absolute;width:100%;height:100%;left:0;top:0}:host .ionx-select-overlay-spinner ion-spinner{position:absolute;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}:host ion-checkbox{margin-right:16px;margin-top:8px;margin-bottom:8px;-ms-grid-row-align:center;align-self:center}:host ion-list{margin:4px 0;padding:0}:host ::ng-deep .cdk-virtual-scroll-content-wrapper{max-width:100%}:host ::ng-deep .hydrated{visibility:visible}:host-context(ion-popover) ion-content{--overflow:initial!important}:host-context(ion-popover) ion-content ion-item ion-label{white-space:normal}:host-context(ion-popover) ion-content ion-item.item:last-child{--border-width:0px}:host-context(.ios) ion-item-divider{--background:transparent;font-size:12px;text-transform:uppercase;letter-spacing:1px;font-weight:500}"]}),d(2,o.Optional()),d(3,o.Optional())],e)}(),w=p,C=function(){function e(e,t,n,i,r){var l=this;this.element=e,this.intl=t,this.popoverController=n,this.modalController=i,this.control=r,this.overlayWhiteSpace="nowrap",this.whiteSpace="nowrap",this.empty=!0,this.ionChange=new o.EventEmitter,this.change=this.ionChange,this.values=[],this.valueComparator=function(e,t){if(l.compareAsString)return null!=e&&null!=t?e.toString()==t.toString():e==t;if(l.comparator){var n=l.comparator(e,t);return 0===n||!0===n}return e===t},r&&(r.valueAccessor=this)}return Object.defineProperty(e.prototype,"listItem",{get:function(){return this._listItem?this._listItem:this._listItem=this.element.nativeElement.closest("ion-item")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"readonly",{get:function(){return!!this._readonly},set:function(e){"string"==typeof e?this.readonly="true"===e:this._readonly=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disabled",{get:function(){return this._disabled},set:function(e){this._disabled=!(!e&&"true"!=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.multiple||this.alwaysArray?this.values.slice(0):this.values.length>0?this.values[0]:void 0},set:function(e){var t=!1,n=Array.isArray(e)?e:null!=e?[e]:[];if(n.length!=this.values.length)t=!0;else for(var o=0;o<this.values.length;o++)if(!this.valueComparator(this.values[o],n[o])){t=!0;break}if(this.values=n,t){this.checkListItemHasValue();var i=this.value;this.fireOnChange&&(this.controlOnChange&&this.controlOnChange(i),this.ionChange.emit(i))}this.fireOnChange=!1},enumerable:!0,configurable:!0}),e.prototype.labelImpl$=function(e){if(this.options instanceof g){this.cachedLabels||(this.cachedLabels=new Array(this.options.length));for(var t=0;t<this.options.length;t++)if(this.valueComparator(e,this.options[t].value))return this.cachedLabels[t]?this.cachedLabels[t]:this.cachedLabels[t]=this.options[t].label?this.options[t].label:this.label?this.label(e):e+""}else if(this.options){this.cachedLabels||(this.cachedLabels=new Array(this.options.length));for(t=0;t<this.options.length;t++)if(this.valueComparator(e,this.options[t]))return this.cachedLabels[t]?this.cachedLabels[t]:this.cachedLabels[t]=this.label?this.label(e):e+""}else if(this.optionsComponents){var n=this.optionsComponents.toArray();for(t=0;t<n.length;t++)if(this.valueComparator(e,n[t].value))return n[t].label}return e},e.prototype.writeValue=function(e){this.value=e},e.prototype.hasValue=function(){return this.values.length>0},e.prototype.checkListItemHasValue=function(){this.listItem&&(this.hasValue()?this.listItem.classList.add("has-value"):this.listItem.classList.remove("has-value"))},Object.defineProperty(e.prototype,"_optionsComponents",{set:function(e){this.optionsComponents=e},enumerable:!0,configurable:!0}),e.prototype.indexOfValue=function(e){if(!this.values)return-1;for(var t=0;t<this.values.length;t++)if(this.valueComparator(e,this.values[t]))return t;return-1},e.prototype.registerOnChange=function(e){this.controlOnChange=e},e.prototype.registerOnTouched=function(e){this.controlOnTouched=e},e.prototype.setDisabledState=function(e){this.disabled=e},e.prototype.open=function(e){return v(this,void 0,void 0,(function(){var t,n,o,i,r,l,a,s,p,c,h,u,d,v,y,b,w,C,O,k,I=this;return f(this,(function(f){switch(f.label){case 0:if((t=this.overlay)||(t="popover"),n=[],this.options instanceof g)try{for(o=m(this.options),i=o.next();!i.done;i=o.next())p=i.value,c=p.value?this.indexOfValue(p.value):-1,n.push({value:p.value,checked:!!p.value&&c>-1,checkedTimestamp:this.orderable&&c,label:p.label?p.label:this.searchTest&&this.labelTemplate?void 0:this.labelImpl$(p.value),disabled:p.disabled,divider:p.divider})}catch(e){y={error:e}}finally{try{i&&!i.done&&(b=o.return)&&b.call(o)}finally{if(y)throw y.error}}else if(this.options)try{for(r=m(this.options),l=r.next();!l.done;l=r.next())p=l.value,c=this.indexOfValue(p),n.push({value:p,checked:c>-1,checkedTimestamp:this.orderable&&c,label:this.labelTemplate&&this.searchTest?void 0:this.labelImpl$(p)})}catch(e){w={error:e}}finally{try{l&&!l.done&&(C=r.return)&&C.call(r)}finally{if(w)throw w.error}}else if(this.optionsComponents)try{for(a=m(this.optionsComponents.toArray()),s=a.next();!s.done;s=a.next())p=s.value,c=this.indexOfValue(p.value),n.push({value:p.value,checked:c>-1,checkedTimestamp:this.orderable&&c,label:p.label,divider:!!p.divider})}catch(e){O={error:e}}finally{try{s&&!s.done&&(k=a.return)&&k.call(a)}finally{if(O)throw O.error}}return this.title&&(h=this.title),!h&&this.listItem&&((u=this.listItem.querySelector("[ionx-select-overlay-title]"))?h=u.innerText:(d=this.listItem.querySelector("ion-label"))&&(h=d.innerText)),!h&&this.element.nativeElement.title&&(h=this.element.nativeElement.title),!h&&this.placeholder&&(h=this.placeholder),v={overlay:t,options:n,multiple:!!this.multiple,title:h,label:this.labelTemplate,orderable:!!this.orderable,empty:!!this.empty,whiteSpace:this.overlayWhiteSpace,valueValidator:this.checkValidator,valueComparator:this.valueComparator,width:this.element.nativeElement.getBoundingClientRect().width,updateValues:function(e){I.fireOnChange=!0,I.value=e,I.controlOnTouched&&I.controlOnTouched()}},"popover"!=t?[3,2]:[4,this.popoverController.create({component:x,componentProps:v,cssClass:"ionx-select-overlay-width",event:e})];case 1:return f.sent().present(),[3,4];case 2:return[4,this.modalController.create({component:x,componentProps:v})];case 3:f.sent().present(),f.label=4;case 4:return[2]}}))}))},e.prototype.initDragula=function(){var e=this;if(!this.orderable||this.disabled||this.readonly)this.dragula&&(this.dragula.destroy(),this.dragula=void 0);else{if(this.dragula)return;this.dragula=w({containers:[this.textContainer.nativeElement],direction:"horizontal",moves:function(t,n,o){return e.values&&e.values.length>1}}),this.dragula.on("drop",(function(t,n,o,i){var r=parseInt(t.getAttribute("ionx--index"),0),l=i?parseInt(i.getAttribute("ionx--index"),0):e.values.length;l>r&&(l-=1);var a=e.values[r];e.values.splice(r,1),e.values.splice(l,0,a),e.controlOnChange&&e.controlOnChange(e.values.slice()),e.ionChange.emit(e.values.slice())}))}},e.prototype.updateCssClasses=function(){this.listItem?(this.listItem.classList.add("item-select"),this.readonly||this.disabled?this.listItem.classList.remove("item-interactive"):this.listItem.classList.add("item-interactive"),this.element.nativeElement.classList.add("in-item")):this.element.nativeElement.classList.remove("in-item")},e.prototype.ngOnChanges=function(e){e.options&&(this.cachedLabels=void 0),(e.orderable||e.readonly||e.disabled)&&(this.initDragula(),this.updateCssClasses())},e.prototype.ngOnInit=function(){this.updateCssClasses(),this.orderable&&this.initDragula()},e.ctorParameters=function(){return[{type:o.ElementRef},{type:l.IntlService},{type:s.PopoverController},{type:s.ModalController},{type:i.NgControl,decorators:[{type:o.Optional}]}]},u([o.ViewChild("textContainer",{static:!0})],e.prototype,"textContainer",void 0),u([o.Input()],e.prototype,"placeholder",void 0),u([o.Input()],e.prototype,"overlay",void 0),u([o.Input()],e.prototype,"overlayWhiteSpace",void 0),u([o.Input(),o.HostBinding("attr.ionx--white-space")],e.prototype,"whiteSpace",void 0),u([o.Input()],e.prototype,"alwaysArray",void 0),u([o.Input()],e.prototype,"compareAsString",void 0),u([o.Input()],e.prototype,"comparator",void 0),u([o.Input()],e.prototype,"multiple",void 0),u([o.Input()],e.prototype,"title",void 0),u([o.Input()],e.prototype,"orderable",void 0),u([o.Input()],e.prototype,"empty",void 0),u([o.Input()],e.prototype,"readonly",null),u([o.Input()],e.prototype,"searchTest",void 0),u([o.Input()],e.prototype,"checkValidator",void 0),u([o.Output()],e.prototype,"ionChange",void 0),u([o.Output()],e.prototype,"change",void 0),u([o.Input()],e.prototype,"disabled",null),u([o.Input()],e.prototype,"value",null),u([o.ContentChild(y,{static:!1})],e.prototype,"labelTemplate",void 0),u([o.Input()],e.prototype,"label",void 0),u([o.Input()],e.prototype,"options",void 0),u([o.ContentChildren(b,{descendants:!0})],e.prototype,"_optionsComponents",null),e=u([o.Component({selector:"ionx-select",host:{"[class.ionx--chips-layout]":"!!orderable","[class.ionx--readonly]":"!!readonly || !!disabled","[class.ionx--orderable]":"!!orderable && !readonly && !disabled && values && values.length > 1"},template:'<ng-template #optionTemplate let-value="value" let-index="index">\n    <span *ngIf="!labelTemplate; else hasLabelTemplate">{{labelImpl$(value)}}</span>\n    <ng-template #hasLabelTemplate>\n        <ng-container *ngTemplateOutlet="labelTemplate.templateRef; context: {$implicit: value, index: index}"></ng-container>\n    </ng-template>\n</ng-template>\n\n<div class="select-inner">\n    <div class="select-text" #textContainer [class.select-placeholder]="values.length == 0">\n        <span *ngIf="values.length == 0; else showValues">{{placeholder}}</span>\n\n        <ng-template #showValues>\n            <ng-template ngFor [ngForOf]="values" let-value let-index="index">\n                <span *ngIf="index > 0 && (!labelTemplate || labelTemplate.separator) && !orderable">{{!labelTemplate ? ", " : labelTemplate.separator}}</span>\n\n                <ion-chip *ngIf="orderable else simpleText" outline="true" [attr.ionx--index]="index">\n                    <ng-template *ngTemplateOutlet="optionTemplate; context: {value: value, index: index}"></ng-template>\n                </ion-chip>\n\n                <ng-template #simpleText>\n                    <ng-template *ngTemplateOutlet="optionTemplate; context: {value: value, index: index}"></ng-template>\n                </ng-template>\n\n            </ng-template>\n        </ng-template>\n    </div>\n\n    <ng-container  *ngIf="!_readonly && !_disabled">\n        <div class="select-icon" role="presentation" *ngIf="!orderable">\n            <div class="select-icon-inner"></div>\n        </div>\n        <button type="button" role="combobox" aria-haspopup="dialog" class="select-cover" (click)="open($event)" *ngIf="!orderable || !values || values.length === 0"></button>\n    </ng-container>\n\n</div>\n',styles:[":host{--placeholder-opacity:.5;--dropdown-icon-opacity:.5;--disabled-opacity:.5;padding:var(--padding-top) var(--padding-end) var(--padding-bottom) var(--padding-start);display:inline-block;overflow:hidden;color:var(--color);font-family:var(--ion-font-family,inherit);max-width:100%}:host .select-inner{display:-webkit-box;display:flex;position:relative}:host .select-icon{position:relative;width:16px;height:20px}:host .select-icon .select-icon-inner{top:50%;right:0;margin-top:-3px;position:absolute;width:0;height:0;border-top:5px solid;border-right:5px solid transparent;border-left:5px solid transparent;color:currentColor;opacity:var(--dropdown-icon-opacity,.5);pointer-events:none}:host .select-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}:host .select-text.select-placeholder{opacity:var(--placeholder-opacity,.5)}:host.select-disabled{opacity:var(--disabled-opacity,.5);pointer-events:none}:host.select-readonly{opacity:1;pointer-events:none}:host.select-readonly .select-icon{display:none}:host[ionx--white-space=normal] .select-text,:host[white-space-normal] .select-text{white-space:normal!important;overflow:auto}:host button{left:0;top:0;margin:0;position:absolute;width:100%;height:100%;border:0;background:0 0;cursor:pointer;-webkit-appearance:none;-moz-appearance:none;appearance:none;outline:0}:host button::-moz-focus-inner{border:0}:host.in-item{position:static}:host ion-chip{max-width:calc(50% - 4px);-webkit-margin-start:0;margin-inline-start:0;margin-bottom:0;cursor:default}:host ion-chip>span{text-overflow:ellipsis;overflow:hidden;white-space:nowrap;line-height:1.1}:host.ionx--orderable ion-chip{cursor:move}:host.ionx--chips-layout .select-text{white-space:normal;overflow:auto;width:100%}:host-context(ion-toolbar){color:var(--ion-toolbar-color);--icon-color:var(--ion-toolbar-color);--padding-start:16px;--padding-end:16px}:host-context(.item-label-stacked){align-self:flex-start;--padding-top:8px;--padding-bottom:8px;--padding-start:0;width:100%}:host-context(.item-label-stacked) .select-text{max-width:calc(100% - 16px);-webkit-box-flex:initial;flex:initial}:host-context(.item-label-stacked).ionx--chips-layout .select-text{-webkit-box-flex:1;flex:1}"]}),d(4,o.Optional())],e)}(),O=function(){function e(){}return e=u([o.NgModule({declarations:[C,b,x,y],entryComponents:[C,b,x],exports:[C,b,x,y],imports:[n.CommonModule,i.FormsModule,s.IonicModule,l.IntlModule,t.ScrollingModule,a.ButtonsModule,r.MatchMediaModule]})],e)}();e.Select=C,e.SelectModule=O,e.SelectOption=b,e.SelectOptions=g,e.ɵa=y,e.ɵb=x,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=select-module.umd.min.js.map