{"version":3,"file":"expanding-searchbar-module.js","sources":["ng://@co.mmons/ionic-extensions/expanding-searchbar/expanding-searchbar-styles.ts","ng://@co.mmons/ionic-extensions/expanding-searchbar/expanding-searchbar.ts","ng://@co.mmons/ionic-extensions/expanding-searchbar/index.ts","ng://@co.mmons/ionic-extensions/expanding-searchbar/expanding-searchbar-module.ts"],"sourcesContent":["import {Component} from \"@angular/core\";\n\n@Component({\n    template: \"\",\n    styleUrls: [\"expanding-searchbar.scss\"]\n})\nexport class ExpandingSearchbarStyles {\n}\n","import {ApplicationRef, ComponentFactoryResolver, Directive, ElementRef, Injector, Input} from \"@angular/core\";\nimport {unsubscribe} from \"@co.mmons/rxjs-utils\";\nimport {IonSearchbar} from \"@ionic/angular\";\nimport {Subscription} from \"rxjs\";\nimport {ExpandingSearchbarStyles} from \"./expanding-searchbar-styles\";\n\nconst expandedCssClass = \"ionx-expanding-searchbar-expanded\";\nconst parentCssClass = \"ionx-expanding-searchbar-parent\";\n\nlet stylesInjected = false;\n\n@Directive({\n    selector: \"ion-searchbar[ionx-expanding-searchbar]\",\n    exportAs: \"ionxExpandingSearchbar\"\n})\nexport class ExpandingSearchbar {\n\n    constructor(\n        injector: Injector,\n        resolver: ComponentFactoryResolver,\n        private appRef: ApplicationRef,\n        private element: ElementRef<HTMLIonSearchbarElement>,\n        private searchbar: IonSearchbar) {\n\n        if (!stylesInjected) {\n            let styles = resolver.resolveComponentFactory(ExpandingSearchbarStyles).create(injector);\n            this.appRef.attachView(styles.hostView);\n        }\n    }\n\n    private subscriptions: Subscription[] = [];\n\n    get parentElement() {\n\n        let parent = this.element.nativeElement.parentElement;\n        if (parent) {\n            return parent;\n        }\n    }\n\n    @Input(\"ionx-expanded\")\n    public get expanded(): boolean {\n        return this.element.nativeElement.classList.contains(expandedCssClass);\n    }\n\n    public set expanded(expanded: boolean) {\n        this.parentElement;\n\n        if (expanded) {\n            this.element.nativeElement.classList.add(expandedCssClass);\n            this.parentElement.classList.add(parentCssClass);\n            this.searchbar.setFocus();\n\n        } else {\n            this.element.nativeElement.classList.remove(expandedCssClass);\n            this.parentElement.classList.remove(parentCssClass);\n            //this.searchbar.value = \"\";\n            setTimeout(() => (this.element.nativeElement.querySelector(\".searchbar-input\") as HTMLElement).blur(), 50);\n        }\n    }\n\n    public expand() {\n        this.expanded = true;\n    }\n\n    collapseIfPossible(cleared?: boolean) {\n\n        if (this.expanded && (cleared || !this.searchbar.value)) {\n            setTimeout(() => {\n                this.expanded = false;\n            }, cleared ? 250 : 0);\n        }\n    }\n\n    ngOnInit() {\n        //this.subscriptions.push(this.searchbar.ionBlur.subscribe(() => this.collapseIfPossible()));\n        this.subscriptions.push(this.searchbar.ionClear.subscribe(() => this.collapseIfPossible(true)));\n        this.element.nativeElement.classList.add(\"ionx-expanding-searchbar\");\n    }\n\n    ngOnDestroy() {\n        unsubscribe(this.subscriptions);\n    }\n}\n","import {NgModule} from \"@angular/core\";\nimport {IonicModule} from \"@ionic/angular\";\nimport {ExpandingSearchbar} from \"./expanding-searchbar\";\nimport {ExpandingSearchbarStyles} from \"./expanding-searchbar-styles\";\n\nexport {ExpandingSearchbar} from \"./expanding-searchbar\";\n\n@NgModule({\n    declarations: [ExpandingSearchbar, ExpandingSearchbarStyles],\n    exports: [ExpandingSearchbar],\n    entryComponents: [ExpandingSearchbarStyles],\n    imports: [IonicModule]\n})\nexport class ExpandingSearchbarModule {\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n\nexport {ExpandingSearchbarStyles as Éµa} from './expanding-searchbar-styles';"],"names":[],"mappings":"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"}